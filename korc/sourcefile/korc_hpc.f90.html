<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Kinetic Orbit Runaway electrons Code (KORC)">
    
    <meta name="author" content="Matt Beidler" >
    <link rel="icon" href="../favicon.png">

    <title>korc_hpc.f90 &ndash; KORC</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">KORC </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>README</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>korc_hpc.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.9% of total for source files.">192 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/korc_hpc.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">korc_hpc.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/korc_hpc.html">korc_hpc</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/korc_hpc.f90.html#src">korc_hpc.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~korc_hpc.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilekorc_hpcf90EfferentGraph" width="198pt" height="32pt"
 viewBox="0.00 0.00 198.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~korc_hpc.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~korc_hpc.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 194,-28 194,4 -4,4"/>
<!-- sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~korc_hpc.f90</title>
<polygon fill="none" stroke="#000000" points="190,-24 117,-24 117,0 190,0 190,-24"/>
<text text-anchor="middle" x="153.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">korc_hpc.f90</text>
</g>
<!-- sourcefile~korc_types.f90 -->
<g id="sourcefile~~korc_hpc.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~korc_types.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/korc_types.f90.html" xlink:title="korc_types.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="81,-24 0,-24 0,0 81,0 81,-24"/>
<text text-anchor="middle" x="40.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_types.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_hpc.f90&#45;&gt;sourcefile~korc_types.f90 -->
<g id="sourcefile~~korc_hpc.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~korc_hpc.f90&#45;&gt;sourcefile~korc_types.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M116.8121,-12C108.7486,-12 100.0686,-12 91.5551,-12"/>
<polygon fill="#000000" stroke="#000000" points="91.3056,-8.5001 81.3056,-12 91.3055,-15.5001 91.3056,-8.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~korc_hpc.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilekorc_hpcf90AfferentGraph" width="641pt" height="401pt"
 viewBox="0.00 0.00 641.00 401.47" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph" class="graph" transform="scale(.5267 .5267) rotate(0) translate(4 758.2384)">
<title>sourcefile~~korc_hpc.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-758.2384 1213,-758.2384 1213,4 -4,4"/>
<!-- sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~korc_hpc.f90</title>
<polygon fill="none" stroke="#000000" points="73,-480.5193 0,-480.5193 0,-456.5193 73,-456.5193 73,-480.5193"/>
<text text-anchor="middle" x="36.5" y="-466.1193" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">korc_hpc.f90</text>
</g>
<!-- sourcefile~korc_energy_pdfs.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~korc_energy_pdfs.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/korc_energy_pdfs.f90.html" xlink:title="korc_energy_pdfs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-559.5193 253,-559.5193 253,-535.5193 366,-535.5193 366,-559.5193"/>
<text text-anchor="middle" x="309.5" y="-545.1193" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_energy_pdfs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_energy_pdfs.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~korc_energy_pdfs.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M252.6593,-557.0161C243.9897,-559.8926 235.4583,-563.6393 228,-568.5193 181.2412,-599.114 201.2795,-690.8401 150.5,-667.5193"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M150.5,-667.5193C79.4684,-634.8978 50.3393,-535.2843 40.6175,-490.6077"/>
<polygon fill="#000000" stroke="#000000" points="44.0328,-489.8389 38.596,-480.7454 37.1754,-491.2446 44.0328,-489.8389"/>
</g>
<!-- sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~korc_hdf5.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node13"><a xlink:href=".././sourcefile/korc_hdf5.f90.html" xlink:title="korc_HDF5.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="192,-520.5193 109,-520.5193 109,-496.5193 192,-496.5193 192,-520.5193"/>
<text text-anchor="middle" x="150.5" y="-506.1193" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_HDF5.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_energy_pdfs.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~korc_energy_pdfs.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M260.4974,-535.4998C241.9345,-530.9467 220.7569,-525.7522 201.9732,-521.1448"/>
<polygon fill="#000000" stroke="#000000" points="202.6525,-517.7078 192.1066,-518.7247 200.9849,-524.5063 202.6525,-517.7078"/>
</g>
<!-- sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~korc_input.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node14"><a xlink:href=".././sourcefile/korc_input.f90.html" xlink:title="korc_input.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="189.5,-404.5193 111.5,-404.5193 111.5,-380.5193 189.5,-380.5193 189.5,-404.5193"/>
<text text-anchor="middle" x="150.5" y="-390.1193" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_input.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_energy_pdfs.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge58" class="edge">
<title>sourcefile~korc_energy_pdfs.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M297.0235,-535.3567C269.5069,-508.5323 203.4257,-444.1136 170.2311,-411.7541"/>
<polygon fill="#000000" stroke="#000000" points="172.5223,-409.0997 162.9185,-404.6254 167.6359,-414.1121 172.5223,-409.0997"/>
</g>
<!-- sourcefile~korc_initialize.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~korc_initialize.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/korc_initialize.f90.html" xlink:title="korc_initialize.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1119,-447.5193 1026,-447.5193 1026,-423.5193 1119,-423.5193 1119,-447.5193"/>
<text text-anchor="middle" x="1072.5" y="-433.1193" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_initialize.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M739,-667.5193C525.9594,-749.5393 446.3903,-785.997 228,-719.5193 188.3183,-707.4403 187.7172,-685.834 150.5,-667.5193"/>
</g>
<!-- sourcefile~korc_velocity_distribution.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~korc_velocity_distribution.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/korc_velocity_distribution.f90.html" xlink:title="korc_velocity_distribution.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="990,-468.5193 843,-468.5193 843,-444.5193 990,-444.5193 990,-468.5193"/>
<text text-anchor="middle" x="916.5" y="-454.1193" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_velocity_distribution.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_velocity_distribution.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_velocity_distribution.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1025.6949,-441.82C1017.544,-442.9173 1008.8489,-444.0878 1000.0593,-445.271"/>
<polygon fill="#000000" stroke="#000000" points="999.5628,-441.8061 990.1192,-446.6091 1000.4968,-448.7436 999.5628,-441.8061"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~korc_spatial_distribution.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/korc_spatial_distribution.f90.html" xlink:title="korc_spatial_distribution.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="988,-426.5193 845,-426.5193 845,-402.5193 988,-402.5193 988,-426.5193"/>
<text text-anchor="middle" x="916.5" y="-412.1193" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_spatial_distribution.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_spatial_distribution.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_spatial_distribution.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1025.6949,-429.2186C1016.9949,-428.0475 1007.6751,-426.7929 998.282,-425.5285"/>
<polygon fill="#000000" stroke="#000000" points="998.4642,-422.0215 988.0866,-424.156 997.5302,-428.9589 998.4642,-422.0215"/>
</g>
<!-- sourcefile~korc_fields.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~korc_fields.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/korc_fields.f90.html" xlink:title="korc_fields.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="630,-365.5193 550,-365.5193 550,-341.5193 630,-341.5193 630,-365.5193"/>
<text text-anchor="middle" x="590" y="-351.1193" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_fields.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M916.5,-374.5193C838.5344,-359.818 817.2112,-368.8525 739,-355.5193"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M739,-355.5193C706.5202,-349.9823 669.4796,-349.4596 640.455,-350.3324"/>
<polygon fill="#000000" stroke="#000000" points="640.0127,-346.8462 630.1477,-350.7104 640.2693,-353.8415 640.0127,-346.8462"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1051.712,-423.3324C1035.3675,-414.1494 1011.7948,-401.771 990,-393.5193 958.4454,-381.5725 949.6562,-380.7713 916.5,-374.5193"/>
</g>
<!-- sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1062.9714,-447.76C1026.7491,-492.8874 891.9107,-648.3278 739,-667.5193"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M739,-667.5193C649.1568,-700.8232 401.9574,-654.6704 309.5,-629.5193"/>
</g>
<!-- sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge59" class="edge">
<title>sourcefile~korc_initialize.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M916.5,-374.5193C818.4714,-356.0349 566.4321,-409.7178 468,-393.5193"/>
</g>
<!-- sourcefile~korc_ppusher.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~korc_ppusher.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/korc_ppusher.f90.html" xlink:title="korc_ppusher.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="963.5,-231.5193 869.5,-231.5193 869.5,-207.5193 963.5,-207.5193 963.5,-231.5193"/>
<text text-anchor="middle" x="916.5" y="-217.1193" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_ppusher.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M905.8545,-207.3938C880.6558,-178.7734 818.5979,-108.7957 807,-100.5193 764.1506,-69.9417 642.5351,-8.8554 590,-5.5193"/>
</g>
<!-- sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M885.5044,-231.6162C863.663,-240.0196 833.6729,-251.3161 807,-260.5193 747.0732,-281.1965 728.162,-276.11 671,-303.5193 653.6607,-311.8336 651.3335,-317.3707 635,-327.5193 630.3059,-330.436 625.282,-333.4453 620.3548,-336.336"/>
<polygon fill="#000000" stroke="#000000" points="618.5771,-333.3209 611.6825,-341.3655 622.0889,-339.3763 618.5771,-333.3209"/>
</g>
<!-- sourcefile~korc_interp.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~korc_interp.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/korc_interp.f90.html" xlink:title="korc_interp.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="509,-175.5193 427,-175.5193 427,-151.5193 509,-151.5193 509,-175.5193"/>
<text text-anchor="middle" x="468" y="-161.1193" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_interp.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_interp.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_interp.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M869.3588,-216.282C798.5989,-211.0368 660.8632,-199.3297 545,-180.5193 536.6472,-179.1633 527.839,-177.471 519.2821,-175.6838"/>
<polygon fill="#000000" stroke="#000000" points="519.9075,-172.2384 509.395,-173.5568 518.4352,-179.0818 519.9075,-172.2384"/>
</g>
<!-- sourcefile~korc_profiles.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~korc_profiles.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node11"><a xlink:href=".././sourcefile/korc_profiles.f90.html" xlink:title="korc_profiles.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="635,-171.5193 545,-171.5193 545,-147.5193 635,-147.5193 635,-171.5193"/>
<text text-anchor="middle" x="590" y="-157.1193" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_profiles.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_profiles.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_profiles.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M884.5252,-207.4873C849.3018,-194.6071 790.7748,-174.3042 739,-161.5193"/>
</g>
<!-- sourcefile~korc_collisions.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~korc_collisions.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node19"><a xlink:href=".././sourcefile/korc_collisions.f90.html" xlink:title="korc_collisions.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="788,-251.5193 690,-251.5193 690,-227.5193 788,-227.5193 788,-251.5193"/>
<text text-anchor="middle" x="739" y="-237.1193" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_collisions.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_collisions.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge74" class="edge">
<title>sourcefile~korc_ppusher.f90&#45;&gt;sourcefile~korc_collisions.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M869.3993,-224.8265C847.5695,-227.2862 821.392,-230.2357 798.2385,-232.8446"/>
<polygon fill="#000000" stroke="#000000" points="797.7274,-229.3799 788.1822,-233.9777 798.5112,-236.3359 797.7274,-229.3799"/>
</g>
<!-- sourcefile~korc_experimental_pdf.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~korc_experimental_pdf.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/korc_experimental_pdf.f90.html" xlink:title="korc_experimental_pdf.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="807,-525.5193 671,-525.5193 671,-501.5193 807,-501.5193 807,-525.5193"/>
<text text-anchor="middle" x="739" y="-511.1193" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_experimental_pdf.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M728.6188,-525.7648C706.3328,-550.9952 650.9589,-608.19 590,-629.5193"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M590,-629.5193C404.9392,-694.2716 328.6709,-749.3452 150.5,-667.5193"/>
</g>
<!-- sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M723.4413,-501.3675C709.1812,-489.9244 687.7958,-471.9781 671,-454.5193 645.7747,-428.2984 620.064,-394.8545 604.5677,-373.8062"/>
<polygon fill="#000000" stroke="#000000" points="607.3038,-371.618 598.583,-365.6016 601.6485,-375.7432 607.3038,-371.618"/>
</g>
<!-- sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M590,-507.5193C537.3147,-494.7011 519.9266,-491.9092 468,-507.5193"/>
</g>
<!-- sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge60" class="edge">
<title>sourcefile~korc_experimental_pdf.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M670.7158,-516.4067C645.0906,-516.0257 615.9099,-513.8232 590,-507.5193"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M590,-507.5193C567.9758,-502.1609 562.6745,-497.7106 545,-483.5193 503.9523,-450.5611 519.9432,-402.0674 468,-393.5193"/>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M739,-629.5193C676.8177,-652.2954 652.008,-606.2731 590,-629.5193"/>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_energy_pdfs.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_energy_pdfs.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M739,-629.5193C735.3957,-630.7252 471.8006,-591.5513 468,-591.5193"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M909.2876,-468.7441C888.3158,-502.8537 823.4492,-598.5874 739,-629.5193"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M468,-591.5193C432.3913,-588.7492 425.4106,-578.0881 391,-568.5193 383.2938,-566.3764 375.1566,-564.1897 367.1252,-562.0759"/>
<polygon fill="#000000" stroke="#000000" points="367.977,-558.6811 357.4171,-559.5416 366.2088,-565.4541 367.977,-558.6811"/>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_experimental_pdf.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_experimental_pdf.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M878.8568,-468.6076C851.9114,-477.2605 815.4317,-488.9751 786.4854,-498.2705"/>
<polygon fill="#000000" stroke="#000000" points="785.0399,-495.0586 776.5889,-501.4485 787.1802,-501.7234 785.0399,-495.0586"/>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M864.9433,-444.4837C857.4045,-441.9577 849.873,-438.9847 843,-435.5193 790.9287,-409.2653 796.4861,-365.3193 739,-355.5193"/>
</g>
<!-- sourcefile~korc_avalanche.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~korc_avalanche.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node10"><a xlink:href=".././sourcefile/korc_avalanche.f90.html" xlink:title="korc_avalanche.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="791,-445.5193 687,-445.5193 687,-421.5193 791,-421.5193 791,-445.5193"/>
<text text-anchor="middle" x="739" y="-431.1193" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_avalanche.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_avalanche.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_avalanche.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M842.7661,-446.9651C828.9519,-445.1751 814.6378,-443.3203 801.2154,-441.581"/>
<polygon fill="#000000" stroke="#000000" points="801.515,-438.0907 791.1481,-440.2766 800.6154,-445.0327 801.515,-438.0907"/>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M468,-591.5193C395.7775,-585.9009 379.4005,-648.5343 309.5,-629.5193"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M309.5,-629.5193C273.6107,-619.7564 259.2116,-630.7478 228,-610.5193 196.9726,-590.4102 173.5597,-553.402 160.9568,-529.9246"/>
<polygon fill="#000000" stroke="#000000" points="163.9299,-528.0541 156.2268,-520.7799 157.7124,-531.2701 163.9299,-528.0541"/>
</g>
<!-- sourcefile~korc_simple_equilibrium_pdf.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~korc_simple_equilibrium_pdf.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node15"><a xlink:href=".././sourcefile/korc_simple_equilibrium_pdf.f90.html" xlink:title="korc_simple_equilibrium_pdf.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="391,-601.5193 228,-601.5193 228,-577.5193 391,-577.5193 391,-601.5193"/>
<text text-anchor="middle" x="309.5" y="-587.1193" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_simple_equilibrium_pdf.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_simple_equilibrium_pdf.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge69" class="edge">
<title>sourcefile~korc_velocity_distribution.f90&#45;&gt;sourcefile~korc_simple_equilibrium_pdf.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M468,-591.5193C446.4461,-589.8426 423.195,-589.0066 401.3179,-588.6532"/>
<polygon fill="#000000" stroke="#000000" points="401.0839,-585.15 391.0394,-588.5202 400.9932,-592.1494 401.0839,-585.15"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M868.9598,-426.5376C860.2174,-429.1872 851.2508,-432.2051 843,-435.5193 826.2121,-442.2628 824.4004,-449.5662 807,-454.5193 714.0191,-480.9867 686.4777,-463.3529 590,-469.5193"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M590,-469.5193C395.723,-489.8107 345.7375,-462.3859 150.5,-468.5193"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_experimental_pdf.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_experimental_pdf.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M859.2839,-426.5506C853.5142,-429.0075 847.9622,-431.9635 843,-435.5193 820.1516,-451.8923 829.1156,-470.1693 807,-487.5193 802.3496,-491.1677 797.1289,-494.3507 791.7016,-497.1167"/>
<polygon fill="#000000" stroke="#000000" points="790.0539,-494.0222 782.437,-501.3865 792.9839,-500.3796 790.0539,-494.0222"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M882.2702,-402.5184C834.852,-385.9898 753.3653,-357.9683 739,-355.5193"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_avalanche.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_avalanche.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M844.8156,-422.1926C830.3373,-423.7424 815.2293,-425.3596 801.1123,-426.8707"/>
<polygon fill="#000000" stroke="#000000" points="800.6019,-423.4052 791.0313,-427.9498 801.347,-430.3655 800.6019,-423.4052"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_profiles.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_profiles.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M861.8958,-402.5127C854.7777,-398.9857 848.1749,-394.4227 843,-388.5193 792.0903,-330.4432 846.7687,-284.7243 807,-218.5193 786.6934,-184.714 777.2855,-170.9733 739,-161.5193"/>
</g>
<!-- sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge51" class="edge">
<title>sourcefile~korc_spatial_distribution.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M590,-469.5193C533.3241,-473.1418 522.3872,-491.1695 468,-507.5193"/>
</g>
<!-- sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M571.1035,-341.3961C538.4449,-319.7153 470.7469,-271.4873 427,-217.5193 405.4664,-190.9546 417.4792,-171.1581 391,-149.5193 361.7612,-125.6254 347.2031,-127.5944 309.5,-125.5193"/>
</g>
<!-- sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_interp.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_interp.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M584.5259,-341.5077C568.1897,-305.8005 520.2248,-202.0067 509,-189.5193 506.35,-186.5712 503.2898,-183.8288 500.0597,-181.316"/>
<polygon fill="#000000" stroke="#000000" points="502.0189,-178.4152 491.8171,-175.5564 498.0095,-184.1532 502.0189,-178.4152"/>
</g>
<!-- sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge52" class="edge">
<title>sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M468,-507.5193C376.8342,-530.9053 266.0383,-523.5406 202.3528,-516.0416"/>
<polygon fill="#000000" stroke="#000000" points="202.5177,-512.5357 192.1662,-514.7932 201.6662,-519.4837 202.5177,-512.5357"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M581.6135,-365.6416C556.9368,-401.0804 485.2308,-502.3394 468,-507.5193"/>
</g>
<!-- sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge63" class="edge">
<title>sourcefile~korc_fields.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M468,-393.5193C363.9768,-369.1132 334.4793,-370.6508 228,-379.5193 218.8144,-380.2844 209.0792,-381.5511 199.7244,-383.0014"/>
<polygon fill="#000000" stroke="#000000" points="199.0695,-379.5619 189.7666,-384.6321 200.2008,-386.4699 199.0695,-379.5619"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M571.4332,-365.6238C547.8986,-379.5482 505.8299,-399.7448 468,-393.5193"/>
</g>
<!-- sourcefile~korc_interp.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~korc_interp.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M433.596,-151.4685C401.8461,-141.2653 353.153,-127.9219 309.5,-125.5193"/>
</g>
<!-- sourcefile~korc_m3d_c1_interface.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~korc_m3d_c1_interface.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node17"><a xlink:href=".././sourcefile/korc_m3d_c1_interface.f90.html" xlink:title="korc_m3d_c1_interface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="379,-215.5193 240,-215.5193 240,-191.5193 379,-191.5193 379,-215.5193"/>
<text text-anchor="middle" x="309.5" y="-201.1193" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_m3d_c1_interface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_interp.f90&#45;&gt;sourcefile~korc_m3d_c1_interface.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge72" class="edge">
<title>sourcefile~korc_interp.f90&#45;&gt;sourcefile~korc_m3d_c1_interface.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M426.7698,-173.9244C408.5654,-178.5186 386.8533,-183.998 367.0883,-188.986"/>
<polygon fill="#000000" stroke="#000000" points="366.103,-185.6249 357.2634,-191.4655 367.8159,-192.4121 366.103,-185.6249"/>
</g>
<!-- sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M150.5,-468.5193C128.465,-471.0494 103.8758,-471.3643 83.1914,-470.9187"/>
<polygon fill="#000000" stroke="#000000" points="83.1673,-467.4167 73.073,-470.6347 82.9708,-474.414 83.1673,-467.4167"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M590,-431.5193C428.9213,-438.7754 388.1548,-436.8254 228,-455.5193 193.3098,-459.5685 185.1977,-464.5354 150.5,-468.5193"/>
</g>
<!-- sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M716.3701,-421.3691C691.0628,-407.7813 649.9025,-385.6818 621.4684,-370.4151"/>
<polygon fill="#000000" stroke="#000000" points="622.8207,-367.1687 612.3547,-365.5218 619.5094,-373.3359 622.8207,-367.1687"/>
</g>
<!-- sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_profiles.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_profiles.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M729.2683,-421.2953C714.9095,-402.7847 687.9246,-366.1241 671,-331.5193 648.7704,-286.0678 657.7919,-268.6916 635,-223.5193 627.1224,-207.9063 615.7863,-191.8097 606.463,-179.6651"/>
<polygon fill="#000000" stroke="#000000" points="609.0409,-177.2811 600.1083,-171.5839 603.5384,-181.6081 609.0409,-177.2811"/>
</g>
<!-- sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge53" class="edge">
<title>sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M590,-431.5193C567.3563,-432.5394 564.4185,-443.8274 545,-455.5193 509.6226,-476.8202 507.5468,-495.6308 468,-507.5193"/>
</g>
<!-- sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge64" class="edge">
<title>sourcefile~korc_avalanche.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M686.9149,-431.331C658.2966,-430.5033 622.176,-430.0699 590,-431.5193"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M590,-431.5193C533.2659,-434.075 524.0379,-402.7412 468,-393.5193"/>
</g>
<!-- sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M579.2383,-147.4507C559.4687,-126.6721 515.0613,-86.2766 468,-85.5193"/>
</g>
<!-- sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_interp.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_interp.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M544.9183,-160.9974C536.6182,-161.2696 527.8953,-161.5556 519.425,-161.8333"/>
<polygon fill="#000000" stroke="#000000" points="519.1437,-158.3405 509.2638,-162.1664 519.3731,-165.3368 519.1437,-158.3405"/>
</g>
<!-- sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge54" class="edge">
<title>sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M573.2557,-171.5302C556.8831,-183.2693 531.2414,-201.6413 509,-217.5193 384.238,-306.5862 330.1129,-303.189 228,-417.5193 206.0018,-442.1495 214.7137,-458.5474 192,-482.5193 189.2497,-485.4219 186.1093,-488.1356 182.8149,-490.6317"/>
<polygon fill="#000000" stroke="#000000" points="180.7113,-487.8304 174.4433,-496.3722 184.67,-493.6035 180.7113,-487.8304"/>
</g>
<!-- sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge65" class="edge">
<title>sourcefile~korc_profiles.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M570.3695,-147.3763C546.4539,-134.0673 504.695,-115.5903 468,-123.5193"/>
</g>
<!-- sourcefile~korc_finalize.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~korc_finalize.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node12"><a xlink:href=".././sourcefile/korc_finalize.f90.html" xlink:title="korc_finalize.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="783,-133.5193 695,-133.5193 695,-109.5193 783,-109.5193 783,-133.5193"/>
<text text-anchor="middle" x="739" y="-119.1193" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_finalize.f90</text>
</a>
</g>
</g>
<!-- sourcefile~korc_finalize.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~korc_finalize.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M468,-85.5193C395.3563,-84.3505 382.1512,-126.035 309.5,-125.5193"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M694.6391,-112.4098C641.1616,-102.176 548.4376,-86.8136 468,-85.5193"/>
</g>
<!-- sourcefile~korc_finalize.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~korc_finalize.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M730.1304,-133.5789C716.8713,-151.7367 691.2728,-187.2993 671,-218.5193 645.2807,-258.1271 617.3811,-305.7662 601.96,-332.5532"/>
<polygon fill="#000000" stroke="#000000" points="598.8106,-331.0094 596.8704,-341.4251 604.8824,-334.4927 598.8106,-331.0094"/>
</g>
<!-- sourcefile~korc_finalize.f90&#45;&gt;sourcefile~korc_profiles.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~korc_finalize.f90&#45;&gt;sourcefile~korc_profiles.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M694.6985,-132.8177C679.1409,-136.7854 661.4683,-141.2925 645.1311,-145.4591"/>
<polygon fill="#000000" stroke="#000000" points="643.9871,-142.1387 635.1622,-148.0015 645.717,-148.9216 643.9871,-142.1387"/>
</g>
<!-- sourcefile~korc_hdf5.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~korc_hdf5.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M116.2962,-496.518C105.1263,-492.5988 92.5581,-488.1888 80.7577,-484.0484"/>
<polygon fill="#000000" stroke="#000000" points="81.6685,-480.6588 71.0736,-480.6504 79.3508,-487.264 81.6685,-480.6588"/>
</g>
<!-- sourcefile~korc_input.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~korc_input.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M132.4364,-404.5618C113.8683,-416.9405 84.7409,-436.3587 63.4486,-450.5536"/>
<polygon fill="#000000" stroke="#000000" points="61.2357,-447.8224 54.8566,-456.2816 65.1186,-453.6467 61.2357,-447.8224"/>
</g>
<!-- sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M292.9732,-601.6727C258.1489,-626.6157 178.1617,-680.2231 150.5,-667.5193"/>
</g>
<!-- sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge56" class="edge">
<title>sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M250.5842,-577.4115C242.8085,-574.9313 235.0857,-571.9903 228,-568.5193 206.4681,-557.9719 185.16,-540.858 170.3526,-527.6016"/>
<polygon fill="#000000" stroke="#000000" points="172.5684,-524.8846 162.8349,-520.7 167.8344,-530.0411 172.5684,-524.8846"/>
</g>
<!-- sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge67" class="edge">
<title>sourcefile~korc_simple_equilibrium_pdf.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M240.4526,-577.4545C235.9323,-574.9855 231.7119,-572.0371 228,-568.5193 189.4343,-531.9708 215.0091,-502.4119 192,-454.5193 184.9378,-439.8196 174.7839,-424.5821 166.2877,-412.8915"/>
<polygon fill="#000000" stroke="#000000" points="168.9738,-410.6384 160.1924,-404.7106 163.3605,-414.8207 168.9738,-410.6384"/>
</g>
<!-- sourcefile~main.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~main.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node16"><a xlink:href=".././sourcefile/main.f90.html" xlink:title="main.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1209,-447.5193 1155,-447.5193 1155,-423.5193 1209,-423.5193 1209,-447.5193"/>
<text text-anchor="middle" x="1182" y="-433.1193" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_hpc.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_hpc.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1177.444,-423.38C1165.3053,-392.687 1129.1922,-311.3839 1072.5,-268.5193"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M739,-5.5193C674.4619,9.3203 655.8957,-12.0872 590,-5.5193"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M309.5,-125.5193C144.8377,-124.3507 63.5056,-370.1571 42.2658,-446.3096"/>
<polygon fill="#000000" stroke="#000000" points="38.8055,-445.697 39.5653,-456.2646 45.5613,-447.5297 38.8055,-445.697"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M916.5,-121.5193C858.199,-93.4146 863.7076,-56.7146 807,-25.5193 779.3984,-10.3355 769.7012,-12.5786 739,-5.5193"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M590,-5.5193C517.4247,1.7143 493.8017,4.756 427,-24.5193 363.9275,-52.1604 375.8018,-106.9116 309.5,-125.5193"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1072.5,-268.5193C996.5102,-211.0641 1002.3151,-162.8876 916.5,-121.5193"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_initialize.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_initialize.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1154.9326,-435.5193C1147.1101,-435.5193 1138.2644,-435.5193 1129.3445,-435.5193"/>
<polygon fill="#000000" stroke="#000000" points="1129.2927,-432.0194 1119.2927,-435.5193 1129.2927,-439.0194 1129.2927,-432.0194"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_ppusher.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_ppusher.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1072.5,-268.5193C1043.7921,-246.8136 1005.2587,-234.5891 973.6722,-227.7785"/>
<polygon fill="#000000" stroke="#000000" points="974.1785,-224.31 963.6823,-225.7523 972.787,-231.1703 974.1785,-224.31"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M739,-317.5193C701.3443,-317.1403 659.7927,-328.1794 630.1571,-338.1298"/>
<polygon fill="#000000" stroke="#000000" points="628.8903,-334.8645 620.5864,-341.4444 631.1812,-341.479 628.8903,-334.8645"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_interp.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_interp.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M916.5,-121.5193C777.4796,-52.8449 584.7722,-115.7393 504.9279,-147.598"/>
<polygon fill="#000000" stroke="#000000" points="503.263,-144.4965 495.3155,-151.5028 505.8975,-150.9818 503.263,-144.4965"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_profiles.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_profiles.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M916.5,-121.5193C843.9967,-85.7035 817.509,-180.9058 739,-161.5193"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M739,-161.5193C708.5783,-154.0072 673.5883,-153.156 645.1633,-154.3442"/>
<polygon fill="#000000" stroke="#000000" points="644.8159,-150.8574 635.0086,-154.8657 645.175,-157.8482 644.8159,-150.8574"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_finalize.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_finalize.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M916.5,-121.5193C878.3658,-102.6815 829.7551,-104.1567 793.0499,-109.5171"/>
<polygon fill="#000000" stroke="#000000" points="792.3536,-106.0838 783.0314,-111.1183 793.4585,-112.9961 792.3536,-106.0838"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge57" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1177.2103,-447.8223C1155.7586,-500.6422 1063.1028,-705.5193 916.5,-705.5193 916.5,-705.5193 916.5,-705.5193 468,-705.5193 357.8316,-705.5193 315.6211,-710.2998 228,-643.5193 189.7382,-614.3581 167.2147,-560.4762 157.0424,-530.3533"/>
<polygon fill="#000000" stroke="#000000" points="160.3524,-529.2133 153.9539,-520.7687 153.6897,-531.3603 160.3524,-529.2133"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge68" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M590,-43.5193C527.8112,-61.8715 531.3775,-109.8248 468,-123.5193"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M468,-123.5193C450.2465,-127.3555 324.4541,-153.2102 309.5,-163.5193"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_m3d_c1_interface.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge70" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_m3d_c1_interface.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M739,-317.5193C588.6958,-316.0064 418.3946,-250.7631 345.5971,-219.6733"/>
<polygon fill="#000000" stroke="#000000" points="346.5527,-216.2736 335.9844,-215.5233 343.7781,-222.7003 346.5527,-216.2736"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M916.5,-317.5193C837.6876,-320.9918 817.8569,-315.2719 739,-317.5193"/>
</g>
<!-- sourcefile~korc_units.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~korc_units.f90</title>
<g id="a_sourcefile~~korc_hpc.f90~~AfferentGraph_node18"><a xlink:href=".././sourcefile/korc_units.f90.html" xlink:title="korc_units.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="507,-57.5193 429,-57.5193 429,-33.5193 507,-33.5193 507,-57.5193"/>
<text text-anchor="middle" x="468" y="-43.1193" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">korc_units.f90</text>
</a>
</g>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_units.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge73" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_units.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M739,-5.5193C672.3961,9.7953 655.5473,-24.1761 590,-43.5193"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M590,-43.5193C566.7432,-50.3825 539.8923,-51.5079 517.3113,-50.6546"/>
<polygon fill="#000000" stroke="#000000" points="517.432,-47.1562 507.265,-50.1367 517.0716,-54.1469 517.432,-47.1562"/>
</g>
<!-- sourcefile~main.f90&#45;&gt;sourcefile~korc_collisions.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge75" class="edge">
<title>sourcefile~main.f90&#45;&gt;sourcefile~korc_collisions.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M916.5,-317.5193C856.8691,-320.1467 794.6819,-281.7085 762.0918,-257.8353"/>
<polygon fill="#000000" stroke="#000000" points="763.8075,-254.7463 753.7113,-251.5343 759.6008,-260.3414 763.8075,-254.7463"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1072.5,-268.5193C1014.5314,-224.6898 989.1027,-314.3205 916.5,-317.5193"/>
</g>
<!-- sourcefile~korc_m3d_c1_interface.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge55" class="edge">
<title>sourcefile~korc_m3d_c1_interface.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M245.8206,-215.7056C239.065,-219.2222 232.8892,-223.7342 228,-229.5193 154.6872,-316.266 253.8843,-387.2823 192,-482.5193 190.1933,-485.2997 187.974,-487.8364 185.5096,-490.139"/>
<polygon fill="#000000" stroke="#000000" points="183.277,-487.4417 177.5491,-496.3548 187.585,-492.9591 183.277,-487.4417"/>
</g>
<!-- sourcefile~korc_m3d_c1_interface.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge66" class="edge">
<title>sourcefile~korc_m3d_c1_interface.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M251.1352,-215.596C242.7544,-219.1153 234.7118,-223.6576 228,-229.5193 184.556,-267.461 163.5186,-335.116 155.127,-370.1358"/>
<polygon fill="#000000" stroke="#000000" points="151.6249,-369.7546 152.8344,-380.2801 158.4528,-371.2977 151.6249,-369.7546"/>
</g>
<!-- sourcefile~korc_units.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge61" class="edge">
<title>sourcefile~korc_units.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M461.3998,-57.574C449.8102,-77.6119 423.8796,-117.7213 391,-139.5193 359.528,-160.3842 340.5885,-142.0873 309.5,-163.5193"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M309.5,-163.5193C278.878,-184.6298 255.885,-157.9066 228,-182.5193 171.4464,-232.4364 156.0984,-327.385 151.9827,-370.3809"/>
<polygon fill="#000000" stroke="#000000" points="148.4935,-370.106 151.1435,-380.3641 155.4689,-370.6925 148.4935,-370.106"/>
</g>
<!-- sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_fields.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_fields.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M694.1438,-251.6711C685.876,-255.2444 677.7384,-259.7862 671,-265.5193 646.7314,-286.1674 657.5554,-305.0124 635,-327.5193 631.9822,-330.5307 628.5454,-333.3161 624.9471,-335.8565"/>
<polygon fill="#000000" stroke="#000000" points="622.9219,-332.997 616.3791,-341.3302 626.6905,-338.896 622.9219,-332.997"/>
</g>
<!-- sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_interp.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_interp.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M689.7853,-243.7742C660.475,-245.097 622.7304,-244.669 590,-237.5193"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M590,-237.5193C549.1177,-228.589 544.0812,-212.3321 509,-189.5193 504.8046,-186.7911 500.3497,-183.9298 495.9815,-181.1439"/>
<polygon fill="#000000" stroke="#000000" points="497.5657,-178.0039 487.2476,-175.5981 493.8134,-183.9132 497.5657,-178.0039"/>
</g>
<!-- sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_profiles.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_profiles.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M716.3701,-227.3691C691.0628,-213.7813 649.9025,-191.6818 621.4684,-176.4151"/>
<polygon fill="#000000" stroke="#000000" points="622.8207,-173.1687 612.3547,-171.5218 619.5094,-179.3359 622.8207,-173.1687"/>
</g>
<!-- sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_hdf5.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_hdf5.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M689.9743,-250.4869C683.5302,-252.3032 677.0631,-254.3203 671,-256.5193 476.9115,-326.9129 258.779,-446.8212 180.4692,-491.2729"/>
<polygon fill="#000000" stroke="#000000" points="178.5805,-488.3208 171.6234,-496.3114 182.045,-494.4033 178.5805,-488.3208"/>
</g>
<!-- sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_input.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge62" class="edge">
<title>sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_input.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M468,-203.5193C396.7758,-189.1811 369.3164,-122.2826 309.5,-163.5193"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M590,-237.5193C535.0082,-225.5069 523.1815,-214.628 468,-203.5193"/>
</g>
<!-- sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_m3d_c1_interface.f90 -->
<g id="sourcefile~~korc_hpc.f90~~AfferentGraph_edge71" class="edge">
<title>sourcefile~korc_collisions.f90&#45;&gt;sourcefile~korc_m3d_c1_interface.f90</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M468,-203.5193C442.7494,-198.4361 414.7738,-197.0701 389.4418,-197.3826"/>
<polygon fill="#000000" stroke="#000000" points="389.059,-193.8899 379.1358,-197.6021 389.2081,-200.8883 389.059,-193.8899"/>
</g>
</g>
</svg>
</div><script>var pansourcefilekorc_hpcf90AfferentGraph = svgPanZoom('#sourcefilekorc_hpcf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,0 66,0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="180,-24 84,-24 84,0 180,0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/korc_hpc.html">korc_hpc</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/korc_hpc.f90.html#src">korc_hpc.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">module </span><span class="n">korc_hpc</span>
<a name="ln-2"></a>  <span class="c">!! @note KORC module containing subroutines to initilize, control, </span>
<a name="ln-3"></a>  <span class="c">!! and to finalize parallel communications. @endnote</span>
<a name="ln-4"></a>  <span class="k">use </span><span class="n">korc_types</span>
<a name="ln-5"></a>  <span class="k">use </span><span class="n">omp_lib</span>
<a name="ln-6"></a>  <span class="k">use </span><span class="n">mpi</span>
<a name="ln-7"></a>
<a name="ln-8"></a>  <span class="k">IMPLICIT NONE</span>
<a name="ln-9"></a>
<a name="ln-10"></a><span class="k">  </span><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">timed_already</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> 
<a name="ln-11"></a>  <span class="c">!! Flag to determine if a first call to WMPI_TIME() was made already.</span>
<a name="ln-12"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">t1</span> 
<a name="ln-13"></a>  <span class="c">!! Variable to be used in timing a parallel section of KORC.</span>
<a name="ln-14"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">PRIVATE</span> <span class="kd">::</span> <span class="n">t2</span> 
<a name="ln-15"></a>  <span class="c">!! Variable to be used in timing a parallel section of KORC.</span>
<a name="ln-16"></a>
<a name="ln-17"></a>  <span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">korc_abort</span><span class="p">,&amp;</span>
<a name="ln-18"></a>       <span class="n">initialize_mpi</span><span class="p">,&amp;</span>
<a name="ln-19"></a>       <span class="n">finalize_mpi</span><span class="p">,&amp;</span>
<a name="ln-20"></a>       <span class="n">initialize_communications</span><span class="p">,&amp;</span>
<a name="ln-21"></a>       <span class="n">timing_KORC</span>
<a name="ln-22"></a>
<a name="ln-23"></a><span class="k">CONTAINS</span>
<a name="ln-24"></a>
<a name="ln-25"></a><span class="k">  subroutine </span><span class="n">korc_abort</span><span class="p">()</span>
<a name="ln-26"></a>    <span class="c">!! @note Subroutine that terminates the simulation. @endnote</span>
<a name="ln-27"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">mpierr</span> 
<a name="ln-28"></a>    <span class="c">!! MPI error status</span>
<a name="ln-29"></a>
<a name="ln-30"></a>    <span class="k">call </span><span class="n">MPI_BARRIER</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-31"></a>
<a name="ln-32"></a>    <span class="k">call </span><span class="n">MPI_ABORT</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-33"></a>  <span class="k">end subroutine </span><span class="n">korc_abort</span>
<a name="ln-34"></a>
<a name="ln-35"></a>  <span class="k">subroutine </span><span class="n">set_paths</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-36"></a>    <span class="c">!! @note Subroutine that sets the input/output paths.@endnote</span>
<a name="ln-37"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">KORC_PARAMS</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> 	<span class="kd">::</span> <span class="n">params</span>
<a name="ln-38"></a>    <span class="c">!! Core KORC simulation parameters.</span>
<a name="ln-39"></a>    <span class="kt">INTEGER</span> 				<span class="kd">::</span> <span class="n">argn</span><span class="p">,</span><span class="n">read_stat</span><span class="p">,</span><span class="n">exei</span>
<a name="ln-40"></a>    <span class="c">!! Number of command line inputs. The default value is </span>
<a name="ln-41"></a>    <span class="c">!! two: the input files path and the outputs path.</span>
<a name="ln-42"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="n">MAX_STRING_LENGTH</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ctmp</span>
<a name="ln-43"></a>
<a name="ln-44"></a>    <span class="n">argn</span> <span class="o">=</span> <span class="nb">command_argument_count</span><span class="p">()</span>
<a name="ln-45"></a>
<a name="ln-46"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">argn</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">2_idef</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-47"></a><span class="k">       call </span><span class="nb">get_command_argument</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">path_to_inputs</span><span class="p">)</span>
<a name="ln-48"></a>       <span class="k">call </span><span class="nb">get_command_argument</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">path_to_outputs</span><span class="p">)</span>
<a name="ln-49"></a>    <span class="k">else if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">path_to_inputs</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;TEST&#39;</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-50"></a><span class="k">       call </span><span class="nb">get_command_argument</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">path_to_outputs</span><span class="p">)</span>
<a name="ln-51"></a>    <span class="k">else</span>
<a name="ln-52"></a><span class="k">       call </span><span class="n">korc_abort</span><span class="p">()</span>
<a name="ln-53"></a>    <span class="k">end if</span>
<a name="ln-54"></a>
<a name="ln-55"></a>    <span class="c">!write(6,*) TRIM(params%path_to_outputs)</span>
<a name="ln-56"></a>    <span class="c">!write(6,*) TRIM(params%path_to_inputs)</span>
<a name="ln-57"></a>    
<a name="ln-58"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-59"></a>
<a name="ln-60"></a><span class="k">       OPEN</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">output_unit_write</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-61"></a>            <span class="k">FILE</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">path_to_outputs</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;output.korc&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-62"></a>            <span class="n">STATUS</span><span class="o">=</span><span class="s1">&#39;UNKNOWN&#39;</span><span class="p">,</span><span class="n">FORM</span><span class="o">=</span><span class="s1">&#39;FORMATTED&#39;</span><span class="p">,</span><span class="n">POSITION</span><span class="o">=</span><span class="s1">&#39;REWIND&#39;</span><span class="p">)</span>
<a name="ln-63"></a>       
<a name="ln-64"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * PATHS * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-65"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;The input file is: &#39;</span><span class="p">,&amp;</span>
<a name="ln-66"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">path_to_inputs</span><span class="p">)</span>
<a name="ln-67"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/)&#39;</span><span class="p">)</span>      
<a name="ln-68"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;The output folder is: &#39;</span><span class="p">,&amp;</span>
<a name="ln-69"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">path_to_outputs</span><span class="p">)</span>
<a name="ln-70"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(&quot;* * * * * * * * * * * * *&quot;,/)&#39;</span><span class="p">)</span>      
<a name="ln-71"></a>
<a name="ln-72"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * GIT INFO * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-73"></a>
<a name="ln-74"></a><span class="cp">#ifdef MAC</span>
<a name="ln-75"></a>       <span class="k">call </span><span class="nb">execute_command_line</span><span class="p">(</span><span class="s2">&quot;/Users/21b/Desktop/KORC/src/get_git_details.sh&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-76"></a>            <span class="n">exitstat</span><span class="o">=</span><span class="n">exei</span><span class="p">)</span>
<a name="ln-77"></a><span class="cp">#elif CORI</span>
<a name="ln-78"></a>       <span class="k">call </span><span class="nb">execute_command_line</span><span class="p">(</span><span class="s2">&quot;/global/u1/m/mbeidler/KORC/src/get_git_details.sh&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-79"></a>            <span class="n">exitstat</span><span class="o">=</span><span class="n">exei</span><span class="p">)</span>
<a name="ln-80"></a><span class="cp">#endif</span>
<a name="ln-81"></a>
<a name="ln-82"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">exei</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-83"></a><span class="k">          write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Error executing get_git_details.sh&#39;</span>
<a name="ln-84"></a>          <span class="k">call </span><span class="n">korc_abort</span>
<a name="ln-85"></a>       <span class="k">end if</span>
<a name="ln-86"></a><span class="k">       </span>
<a name="ln-87"></a><span class="k">       OPEN</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">default_unit_open</span><span class="p">,</span><span class="k">FILE</span><span class="o">=</span><span class="s1">&#39;git_hash.txt&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-88"></a>            <span class="n">STATUS</span><span class="o">=</span><span class="s1">&#39;OLD&#39;</span><span class="p">,</span><span class="n">POSITION</span><span class="o">=</span><span class="s1">&#39;REWIND&#39;</span><span class="p">)</span>
<a name="ln-89"></a>       <span class="k">READ</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">default_unit_open</span><span class="p">,</span><span class="n">FMT</span><span class="o">=</span><span class="s1">&#39;(a)&#39;</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">read_stat</span><span class="p">)</span> <span class="n">ctmp</span>
<a name="ln-90"></a>       
<a name="ln-91"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">read_stat</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-92"></a><span class="k">          write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Error reading git_hash.txt&#39;</span>
<a name="ln-93"></a>          <span class="k">call </span><span class="n">korc_abort</span>
<a name="ln-94"></a>       <span class="k">end if</span>
<a name="ln-95"></a><span class="k">       write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Git hash of most recent commit is: &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-96"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">ctmp</span><span class="p">)</span>
<a name="ln-97"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/)&#39;</span><span class="p">)</span>      
<a name="ln-98"></a>       <span class="k">CLOSE</span><span class="p">(</span><span class="n">default_unit_open</span><span class="p">,</span><span class="n">STATUS</span><span class="o">=</span><span class="s1">&#39;DELETE&#39;</span><span class="p">)</span>
<a name="ln-99"></a>
<a name="ln-100"></a>       <span class="k">OPEN</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">default_unit_open</span><span class="p">,</span><span class="k">FILE</span><span class="o">=</span><span class="s1">&#39;git_diff.txt&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-101"></a>            <span class="n">STATUS</span><span class="o">=</span><span class="s1">&#39;OLD&#39;</span><span class="p">,</span><span class="n">POSITION</span><span class="o">=</span><span class="s1">&#39;REWIND&#39;</span><span class="p">)</span>
<a name="ln-102"></a>
<a name="ln-103"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Git diff of HEAD and most recent commit is:&#39;</span>
<a name="ln-104"></a>       <span class="k">DO</span>
<a name="ln-105"></a><span class="k">          READ</span><span class="p">(</span><span class="n">UNIT</span><span class="o">=</span><span class="n">default_unit_open</span><span class="p">,</span><span class="n">FMT</span><span class="o">=</span><span class="s1">&#39;(a)&#39;</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">read_stat</span><span class="p">)</span> <span class="n">ctmp</span>
<a name="ln-106"></a>          
<a name="ln-107"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">read_stat</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-108"></a><span class="k">             write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Error reading git_diff.txt&#39;</span>
<a name="ln-109"></a>             <span class="k">call </span><span class="n">korc_abort</span>
<a name="ln-110"></a>          <span class="k">else if</span> <span class="p">(</span><span class="n">read_stat</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-111"></a><span class="k">             CLOSE</span><span class="p">(</span><span class="n">default_unit_open</span><span class="p">,</span><span class="n">STATUS</span><span class="o">=</span><span class="s1">&#39;DELETE&#39;</span><span class="p">)</span>
<a name="ln-112"></a>       
<a name="ln-113"></a>             <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(&quot;* * * * * * * * * * * * * * * * *&quot;,/)&#39;</span><span class="p">)</span>
<a name="ln-114"></a>             <span class="k">RETURN</span>
<a name="ln-115"></a><span class="k">          end if</span>
<a name="ln-116"></a><span class="k">          write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">ctmp</span><span class="p">)</span>
<a name="ln-117"></a>       <span class="k">END DO</span>
<a name="ln-118"></a>
<a name="ln-119"></a><span class="k">     </span>
<a name="ln-120"></a><span class="k">    end if</span>
<a name="ln-121"></a><span class="k">  end subroutine </span><span class="n">set_paths</span>
<a name="ln-122"></a>
<a name="ln-123"></a>  <span class="k">subroutine </span><span class="n">initialize_mpi</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-124"></a>    <span class="c">!! @note Subroutine that initialize MPI communications.@endnote</span>
<a name="ln-125"></a>    <span class="c">!! Through this subroutine the default MPI communicator MPI_COMM_WORLD </span>
<a name="ln-126"></a>    <span class="c">!! is initialized. Also, a Cartesian</span>
<a name="ln-127"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">KORC_PARAMS</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> 	<span class="kd">::</span> <span class="n">params</span>
<a name="ln-128"></a>    <span class="c">!! Core KORC simulation parameters.</span>
<a name="ln-129"></a>    <span class="kt">INTEGER</span> 				<span class="kd">::</span> <span class="n">mpierr</span>
<a name="ln-130"></a>    <span class="c">!! MPI error status.</span>
<a name="ln-131"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> 			<span class="kd">::</span> <span class="n">NDIMS</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-132"></a>    <span class="c">!! Number of dimensions of non-standard topology. </span>
<a name="ln-133"></a>    <span class="c">!! NDIMS=1 for a 1-D MPI topology, NDIMS=2 for a 2-D MPI topology, </span>
<a name="ln-134"></a>    <span class="c">!! and NDIMS=3 for a 3-D MPI topology.</span>
<a name="ln-135"></a>    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> 	<span class="kd">::</span> <span class="n">DIMS</span>
<a name="ln-136"></a>    <span class="c">!! Dimension of the non-standard MPI topology params::mpi_params::mpi_topo. </span>
<a name="ln-137"></a>    <span class="c">!! This is equal to the number of MPI processes in KORC.</span>
<a name="ln-138"></a>    <span class="kt">LOGICAL</span> 				<span class="kd">::</span> <span class="n">all_mpis_initialized</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-139"></a>    <span class="c">!! Flag to determine if all the MPI processes were initialized correctly.</span>
<a name="ln-140"></a>    <span class="kt">LOGICAL</span> 				<span class="kd">::</span> <span class="n">mpi_process_initialized</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-141"></a>    <span class="c">!! Flag to determine if a given MPI process was initialized correctly.</span>
<a name="ln-142"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">PARAMETER</span> 			<span class="kd">::</span> <span class="n">REORDER</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-143"></a>    <span class="c">!! Flag to determine if the new MPI topology params::mpi_params::mpi_topo </span>
<a name="ln-144"></a>    <span class="c">!! needs to be re-ordered.</span>
<a name="ln-145"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span> 	<span class="kd">::</span> <span class="n">PERIODS</span> <span class="c">!&lt; Something here</span>
<a name="ln-146"></a>    <span class="c">!! Array of logicals determining what dimensions of the new MPI </span>
<a name="ln-147"></a>    <span class="c">!! topology params::mpi_params::mpi_topo are periodic (T) or not (F).</span>
<a name="ln-148"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ii</span>
<a name="ln-149"></a>    <span class="c">!! Variable to iterate over different MPI processes.</span>
<a name="ln-150"></a>
<a name="ln-151"></a>    <span class="k">call </span><span class="n">MPI_INIT</span><span class="p">(</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-152"></a>
<a name="ln-153"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">mpierr</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">MPI_SUCCESS</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-154"></a><span class="k">       write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * COMMUNICATIONS * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-155"></a>       <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot; ERROR: Initializing MPI. Aborting... &quot;)&#39;</span><span class="p">)</span>
<a name="ln-156"></a>       <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * * * ** * * * * * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-157"></a>       <span class="k">call </span><span class="n">MPI_ABORT</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-158"></a>    <span class="k">end if</span>
<a name="ln-159"></a>
<a name="ln-160"></a><span class="k">    call </span><span class="n">MPI_INITIALIZED</span><span class="p">(</span><span class="n">mpi_process_initialized</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-161"></a>
<a name="ln-162"></a>    <span class="k">call </span><span class="n">MPI_REDUCE</span><span class="p">(</span><span class="n">mpi_process_initialized</span><span class="p">,</span><span class="n">all_mpis_initialized</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-163"></a>         <span class="n">MPI_LOGICAL</span><span class="p">,</span><span class="n">MPI_LAND</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-164"></a>
<a name="ln-165"></a>    <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">all_mpis_initialized</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-166"></a>         <span class="n">MPI_LOGICAL</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-167"></a>
<a name="ln-168"></a>    <span class="k">call </span><span class="n">MPI_COMM_SIZE</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">nmpi</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-169"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">mpierr</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">MPI_SUCCESS</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-170"></a><span class="k">       write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * COMMUNICATIONS * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-171"></a>       <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot; ERROR: Obtaining size of communicator. Aborting... &quot;)&#39;</span><span class="p">)</span>
<a name="ln-172"></a>       <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * * * ** * * * * * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-173"></a>       <span class="k">call </span><span class="n">MPI_ABORT</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-174"></a>    <span class="k">end if</span>
<a name="ln-175"></a>
<a name="ln-176"></a>    <span class="c">! * * * Getting the rank of the MPI process in the WORLD COMMON communicator * * * !</span>
<a name="ln-177"></a>    <span class="k">call </span><span class="n">MPI_COMM_RANK</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-178"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">mpierr</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">MPI_SUCCESS</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-179"></a><span class="k">       write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * COMMUNICATIONS * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-180"></a>       <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot; ERROR: Obtaining MPI rank. Aborting... &quot;)&#39;</span><span class="p">)</span>
<a name="ln-181"></a>       <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * * * ** * * * * * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-182"></a>       <span class="k">call </span><span class="n">MPI_ABORT</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-183"></a>    <span class="k">end if</span>
<a name="ln-184"></a>    
<a name="ln-185"></a>    <span class="c">! * * * Here a Cartesian topology for MPI is created * * * !</span>
<a name="ln-186"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">DIMS</span><span class="p">(</span><span class="n">NDIMS</span><span class="p">))</span>
<a name="ln-187"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PERIODS</span><span class="p">(</span><span class="n">NDIMS</span><span class="p">))</span>
<a name="ln-188"></a>
<a name="ln-189"></a>    <span class="c">! This loop isn&#39;t necessary but helps to do things more general in the future</span>
<a name="ln-190"></a>    <span class="k">do </span><span class="n">ii</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">NDIMS</span>
<a name="ln-191"></a>       <span class="n">DIMS</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">=</span> <span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">nmpi</span>
<a name="ln-192"></a>       <span class="n">PERIODS</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-193"></a>    <span class="k">end do</span>
<a name="ln-194"></a>
<a name="ln-195"></a>    <span class="c">! * * * Here a periodic topology for MPI is created * * * !</span>
<a name="ln-196"></a>    <span class="k">call </span><span class="n">MPI_CART_CREATE</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="n">NDIMS</span><span class="p">,</span> <span class="n">DIMS</span><span class="p">,</span> <span class="n">PERIODS</span><span class="p">,</span> <span class="n">REORDER</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-197"></a>         <span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">mpi_topo</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-198"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">mpierr</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">MPI_SUCCESS</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-199"></a><span class="k">       write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * COMMUNICATIONS * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-200"></a>       <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot; ERROR: Creating new MPI topology. Aborting... &quot;)&#39;</span><span class="p">)</span>
<a name="ln-201"></a>       <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * * * ** * * * * * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-202"></a>       <span class="k">call </span><span class="n">MPI_ABORT</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-203"></a>    <span class="k">end if</span>
<a name="ln-204"></a>
<a name="ln-205"></a>    <span class="c">! * * * Getting the rank of the MPI process in the new topology * * * !</span>
<a name="ln-206"></a>    <span class="k">call </span><span class="n">MPI_COMM_RANK</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">mpi_topo</span><span class="p">,</span> <span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank_topo</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-207"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">mpierr</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">MPI_SUCCESS</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-208"></a><span class="k">       write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * COMMUNICATIONS * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-209"></a>       <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot; ERROR: Obtaining new MPI topology ranks. Aborting... &quot;)&#39;</span><span class="p">)</span>
<a name="ln-210"></a>       <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * * * ** * * * * * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-211"></a>       <span class="k">call </span><span class="n">MPI_ABORT</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-212"></a>    <span class="k">end if</span>
<a name="ln-213"></a>
<a name="ln-214"></a><span class="k">    DEALLOCATE</span><span class="p">(</span><span class="n">DIMS</span><span class="p">)</span>
<a name="ln-215"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">PERIODS</span><span class="p">)</span>
<a name="ln-216"></a>
<a name="ln-217"></a>
<a name="ln-218"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">all_mpis_initialized</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-219"></a>
<a name="ln-220"></a><span class="k">       call </span><span class="n">MPI_BARRIER</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-221"></a>
<a name="ln-222"></a>       <span class="k">call </span><span class="n">set_paths</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-223"></a>       
<a name="ln-224"></a>       <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-225"></a><span class="k">          write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * COMMUNICATIONS  * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-226"></a>          <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;  MPI communications initialized!  &quot;)&#39;</span><span class="p">)</span>
<a name="ln-227"></a>          <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;  Number of MPI processes: &quot;,I5)&#39;</span><span class="p">)</span> <span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">nmpi</span>
<a name="ln-228"></a>          <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * * * * * * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-229"></a>       <span class="k">end if</span>
<a name="ln-230"></a><span class="k">    else</span>
<a name="ln-231"></a><span class="k">       if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-232"></a><span class="k">          write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * COMMUNICATIONS * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-233"></a>          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot; ERROR: MPI not initialized. Aborting... &quot;)&#39;</span><span class="p">)</span>
<a name="ln-234"></a>          <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * * * ** * * * * * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-235"></a>          <span class="k">call </span><span class="n">MPI_ABORT</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-236"></a>       <span class="k">end if</span>
<a name="ln-237"></a><span class="k">    end if</span>
<a name="ln-238"></a> 
<a name="ln-239"></a>    <span class="c">!...</span>
<a name="ln-240"></a>  <span class="k">end subroutine </span><span class="n">initialize_mpi</span>
<a name="ln-241"></a>
<a name="ln-242"></a>
<a name="ln-243"></a>  <span class="k">subroutine </span><span class="n">timing_KORC</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-244"></a>    <span class="c">!! @note Subroutine for timing the execution of any parallel</span>
<a name="ln-245"></a>    <span class="c">!! section of KORC. @endnote</span>
<a name="ln-246"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">KORC_PARAMS</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> 	<span class="kd">::</span> <span class="n">params</span>
<a name="ln-247"></a>    <span class="c">!! Core KORC simulation parameters.</span>
<a name="ln-248"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> 				<span class="kd">::</span> <span class="n">individual_runtime</span>
<a name="ln-249"></a>    <span class="c">!! Execution time of each MPI process.</span>
<a name="ln-250"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span>   <span class="kd">::</span> <span class="n">runtime</span>
<a name="ln-251"></a>    <span class="c">!! Execution time of KORC defined as the average of the </span>
<a name="ln-252"></a>    <span class="c">!! execution times of all MPI processes.</span>
<a name="ln-253"></a>    <span class="kt">INTEGER</span> 				<span class="kd">::</span> <span class="n">mpierr</span>
<a name="ln-254"></a>    <span class="c">!! MPI error status.</span>
<a name="ln-255"></a>    
<a name="ln-256"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">timed_already</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-257"></a><span class="k">       </span><span class="n">t2</span> <span class="o">=</span> <span class="n">MPI_WTIME</span><span class="p">()</span>
<a name="ln-258"></a>
<a name="ln-259"></a>       <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">runtime</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">nmpi</span><span class="p">))</span>
<a name="ln-260"></a>
<a name="ln-261"></a>       <span class="n">individual_runtime</span> <span class="o">=</span> <span class="n">t2</span> <span class="o">-</span> <span class="n">t1</span>
<a name="ln-262"></a>
<a name="ln-263"></a>       <span class="k">call </span><span class="n">MPI_BARRIER</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-264"></a>
<a name="ln-265"></a>       <span class="k">call </span><span class="n">MPI_GATHER</span><span class="p">(</span><span class="n">individual_runtime</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">MPI_DOUBLE_PRECISION</span><span class="p">,</span><span class="n">runtime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-266"></a>            <span class="mi">1</span><span class="p">,</span><span class="n">MPI_DOUBLE_PRECISION</span><span class="p">,</span><span class="mi">0_idef</span><span class="p">,</span> <span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-267"></a>
<a name="ln-268"></a>       <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0_idef</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-269"></a><span class="k">          write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(&quot;Timing: &quot;,F30.16,&quot; s&quot;)&#39;</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-270"></a>               <span class="nb">SUM</span><span class="p">(</span><span class="n">runtime</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">nmpi</span><span class="p">,</span><span class="n">rp</span><span class="p">)</span>
<a name="ln-271"></a>       <span class="k">end if</span>
<a name="ln-272"></a>
<a name="ln-273"></a><span class="k">       call </span><span class="n">MPI_BARRIER</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-274"></a>
<a name="ln-275"></a>       <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">runtime</span><span class="p">)</span>
<a name="ln-276"></a>
<a name="ln-277"></a>       <span class="n">timed_already</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-278"></a>    <span class="k">end if</span>
<a name="ln-279"></a>
<a name="ln-280"></a><span class="k">    </span><span class="n">t1</span> <span class="o">=</span> <span class="n">MPI_WTIME</span><span class="p">()</span>
<a name="ln-281"></a>
<a name="ln-282"></a>    <span class="n">timed_already</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-283"></a>    
<a name="ln-284"></a>  <span class="k">end subroutine </span><span class="n">timing_KORC</span>
<a name="ln-285"></a>
<a name="ln-286"></a>  <span class="c">!&gt; @brief Subroutine for finalizing MPI communications.</span>
<a name="ln-287"></a>  <span class="c">!! @details This subroutine finalizes all the MPI communications and looks for errors durignt this procces.</span>
<a name="ln-288"></a>  <span class="c">!!</span>
<a name="ln-289"></a>  <span class="c">!! @param[in] params Core KORC simulation parameters.</span>
<a name="ln-290"></a>  <span class="c">!! @param mpi_process_finalized Flag indicating whether an individual MPI process was finalized correctly.</span>
<a name="ln-291"></a>  <span class="c">!! @param mpierr MPI error status.</span>
<a name="ln-292"></a>  <span class="k">subroutine </span><span class="n">finalize_mpi</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-293"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">KORC_PARAMS</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> 	<span class="kd">::</span> <span class="n">params</span>
<a name="ln-294"></a>    <span class="kt">LOGICAL</span> 						<span class="kd">::</span> <span class="n">mpi_process_finalized</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-295"></a>    <span class="kt">INTEGER</span> 						<span class="kd">::</span> <span class="n">mpierr</span>
<a name="ln-296"></a>
<a name="ln-297"></a>    <span class="k">call </span><span class="n">MPI_BARRIER</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-298"></a>
<a name="ln-299"></a>    <span class="k">call </span><span class="n">MPI_FINALIZE</span><span class="p">(</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-300"></a>
<a name="ln-301"></a>    <span class="k">call </span><span class="n">MPI_FINALIZED</span><span class="p">(</span><span class="n">mpi_process_finalized</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-302"></a>
<a name="ln-303"></a>    <span class="k">if</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">mpi_process_finalized</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-304"></a><span class="k">       write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * COMMUNICATIONS * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-305"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot; ERROR: MPI not finalized well. MPI process: &quot;,I5)&#39;</span><span class="p">)</span> <span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span>
<a name="ln-306"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * * * ** * * * * * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-307"></a>    <span class="k">end if</span>
<a name="ln-308"></a><span class="k">  end subroutine </span><span class="n">finalize_mpi</span>
<a name="ln-309"></a>
<a name="ln-310"></a>
<a name="ln-311"></a>  <span class="c">! * * * * * * * * * * * *  * * * * * * * * * * * * * !</span>
<a name="ln-312"></a>  <span class="c">! ** SUBROUTINES FOR INITIALIZING COMMUNICATIONS  ** !</span>
<a name="ln-313"></a>  <span class="c">! * * * * * * * * * * * *  * * * * * * * * * * * * * !</span>
<a name="ln-314"></a>
<a name="ln-315"></a>  <span class="c">!! @note Subroutine for initializing MPI and open MP communications. @endnote</span>
<a name="ln-316"></a>  <span class="c">!! This subroutine initializes MPI and open MP communications and looks for</span>
<a name="ln-317"></a>  <span class="c">!! errors durignt this procces. The system environment</span>
<a name="ln-318"></a>  <span class="c">!! variables, which are modified by the user at the moment of</span>
<a name="ln-319"></a>  <span class="c">!! running/submitting a KORC simulation, are used to determine the</span>
<a name="ln-320"></a>  <span class="c">!! open MP configuration. Some open MP parameters are displayed on the</span>
<a name="ln-321"></a>  <span class="c">!! screen/output file.</span>
<a name="ln-322"></a>  <span class="c">!!</span>
<a name="ln-323"></a>  <span class="c">!! @param[in] params Core KORC simulation parameters.</span>
<a name="ln-324"></a>  <span class="c">!! @param mpi_process_finalized Flag indicating whether an individual MPI process was finalized correctly.</span>
<a name="ln-325"></a>  <span class="c">!! @param mpierr MPI error status.</span>
<a name="ln-326"></a>  <span class="k">subroutine </span><span class="n">initialize_communications</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-327"></a>    <span class="k">TYPE</span><span class="p">(</span><span class="n">KORC_PARAMS</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> 	<span class="kd">::</span> <span class="n">params</span>
<a name="ln-328"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="n">MAX_STRING_LENGTH</span><span class="p">)</span> 		<span class="kd">::</span> <span class="n">string</span>
<a name="ln-329"></a>
<a name="ln-330"></a>    <span class="k">call </span><span class="n">initialize_mpi</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a name="ln-331"></a>
<a name="ln-332"></a>    <span class="c">!$OMP PARALLEL SHARED(params)</span>
<a name="ln-333"></a>    <span class="n">params</span><span class="p">%</span><span class="n">num_omp_threads</span> <span class="o">=</span> <span class="n">OMP_GET_NUM_THREADS</span><span class="p">()</span>
<a name="ln-334"></a>    <span class="c">!$OMP END PARALLEL</span>
<a name="ln-335"></a>
<a name="ln-336"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">mpi_params</span><span class="p">%</span><span class="n">rank</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-337"></a><span class="k">       write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;* * * * * * * OMP SET-UP * * * * * * *&quot;)&#39;</span><span class="p">)</span>
<a name="ln-338"></a>       <span class="c">!$OMP PARALLEL</span>
<a name="ln-339"></a>       <span class="c">!$OMP MASTER</span>
<a name="ln-340"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;OMP threads per MPI process: &quot;,I3)&#39;</span><span class="p">)</span> <span class="n">OMP_GET_NUM_THREADS</span><span class="p">()</span>
<a name="ln-341"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;Cores available per MPI process: &quot;,I3)&#39;</span><span class="p">)</span> <span class="n">OMP_GET_NUM_PROCS</span><span class="p">()</span>
<a name="ln-342"></a>       <span class="c">!$OMP END MASTER</span>
<a name="ln-343"></a>       <span class="c">!$OMP END PARALLEL</span>
<a name="ln-344"></a><span class="cp">#ifdef GNU</span>
<a name="ln-345"></a>       <span class="k">call </span><span class="nb">GET_ENVIRONMENT_VARIABLE</span><span class="p">(</span><span class="s2">&quot;OMP_PLACES&quot;</span><span class="p">,</span><span class="n">string</span><span class="p">)</span>
<a name="ln-346"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;OMP places: &quot;,A30)&#39;</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<a name="ln-347"></a>       <span class="k">call </span><span class="nb">GET_ENVIRONMENT_VARIABLE</span><span class="p">(</span><span class="s2">&quot;GOMP_CPU_AFFINITY&quot;</span><span class="p">,</span><span class="n">string</span><span class="p">)</span>
<a name="ln-348"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(/,&quot;OMP CPU affinity: &quot;,A30)&#39;</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<a name="ln-349"></a><span class="cp">#endif</span>
<a name="ln-350"></a>       <span class="k">write</span><span class="p">(</span><span class="n">output_unit_write</span><span class="p">,</span><span class="s1">&#39;(&quot;* * * * * * * * * * * *  * * * * * * *&quot;,/)&#39;</span><span class="p">)</span>
<a name="ln-351"></a>    <span class="k">end if</span>
<a name="ln-352"></a><span class="k">  end subroutine </span><span class="n">initialize_communications</span>
<a name="ln-353"></a>
<a name="ln-354"></a><span class="k">end module </span><span class="n">korc_hpc</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> KORC was developed by Matt Beidler</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>