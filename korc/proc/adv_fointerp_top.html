<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Kinetic Orbit Runaway electrons Code (KORC)">
    
    <meta name="author" content="Matt Beidler" >
    <link rel="icon" href="../favicon.png">

    <title>adv_FOinterp_top &ndash; KORC</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">KORC </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>README</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/main.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/main.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>adv_FOinterp_top
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.6% of total for procedures.">123 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/korc_ppusher.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/korc_ppusher.f90.html'>korc_ppusher.f90</a></li>
    
     <li><a href='../module/korc_ppusher.html'>korc_ppusher</a></li>
    
  
     <li class="active">adv_FOinterp_top</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/adv_fointerp_top.html#src">adv_FOinterp_top</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine adv_FOinterp_top(params, F, P, spp)
    
    
   
</h2>
    
  


    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-params~70"></span>type(KORC_PARAMS),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>params</strong></td><td><p>Core KORC simulation parameters.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-f~21"></span>type(FIELDS),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>F</strong></td><td><p>An instance of the KORC derived type FIELDS.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-p~23"></span>type(PROFILES),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>P</strong></td><td><p>An instance of the KORC derived type PROFILES.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-spp~27"></span>type(SPECIES),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>spp</strong></td><td><p>An instance of the derived type SPECIES containing all the parameters
 and simulation variables of the different species in the simulation.</p></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~adv_fointerp_top~~CallsGraph Pages: 1 -->
<svg id="procadv_fointerp_topCallsGraph" width="641pt" height="511pt"
 viewBox="0.00 0.00 641.00 511.08" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~adv_fointerp_top~~CallsGraph" class="graph" transform="scale(.6158 .6158) rotate(0) translate(4 826)">
<title>proc~~adv_fointerp_top~~CallsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-826 1037,-826 1037,4 -4,4"/>
<!-- proc~adv_fointerp_top -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node1" class="node">
<title>proc~adv_fointerp_top</title>
<polygon fill="none" stroke="#000000" points="97,-586 0,-586 0,-562 97,-562 97,-586"/>
<text text-anchor="middle" x="48.5" y="-571.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">adv_FOinterp_top</text>
</g>
<!-- cart_to_cyl_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node2" class="node">
<title>cart_to_cyl_p</title>
<polygon fill="#777777" stroke="#777777" points="624,-586 549,-586 549,-562 624,-562 624,-586"/>
<text text-anchor="middle" x="586.5" y="-571.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cart_to_cyl_p</text>
</g>
<!-- proc~adv_fointerp_top&#45;&gt;cart_to_cyl_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge1" class="edge">
<title>proc~adv_fointerp_top&#45;&gt;cart_to_cyl_p</title>
<path fill="none" stroke="#000000" d="M97.1928,-574C199.7433,-574 436.8734,-574 538.6669,-574"/>
<polygon fill="#000000" stroke="#000000" points="538.9536,-577.5001 548.9536,-574 538.9536,-570.5001 538.9536,-577.5001"/>
</g>
<!-- proc~advance_fp3dinterp_vars -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node3" class="node">
<title>proc~advance_fp3dinterp_vars</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node3"><a xlink:href=".././proc/advance_fp3dinterp_vars.html" xlink:title="advance_FP3Dinterp_vars">
<polygon fill="#d9534f" stroke="#d9534f" points="270,-503 133,-503 133,-479 270,-479 270,-503"/>
<text text-anchor="middle" x="201.5" y="-488.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advance_FP3Dinterp_vars</text>
</a>
</g>
</g>
<!-- proc~adv_fointerp_top&#45;&gt;proc~advance_fp3dinterp_vars -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge2" class="edge">
<title>proc~adv_fointerp_top&#45;&gt;proc~advance_fp3dinterp_vars</title>
<path fill="none" stroke="#000000" d="M70.7475,-561.9311C96.9225,-547.7316 140.5558,-524.0613 170.1503,-508.0067"/>
<polygon fill="#000000" stroke="#000000" points="172.1047,-510.9284 179.2256,-503.0835 168.7668,-504.7754 172.1047,-510.9284"/>
</g>
<!-- proc~interp_fofields1_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node4" class="node">
<title>proc~interp_fofields1_p</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node4"><a xlink:href=".././proc/interp_fofields1_p.html" xlink:title="interp_FOfields1_p">
<polygon fill="#d9534f" stroke="#d9534f" points="442,-744 341,-744 341,-720 442,-720 442,-744"/>
<text text-anchor="middle" x="391.5" y="-729.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interp_FOfields1_p</text>
</a>
</g>
</g>
<!-- proc~adv_fointerp_top&#45;&gt;proc~interp_fofields1_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge3" class="edge">
<title>proc~adv_fointerp_top&#45;&gt;proc~interp_fofields1_p</title>
<path fill="none" stroke="#000000" d="M73.971,-586.1701C90.7186,-594.1443 113.1307,-604.7628 133,-614 212.0553,-650.7527 305.1473,-692.994 355.2249,-715.6326"/>
<polygon fill="#000000" stroke="#000000" points="354.0959,-718.9632 364.65,-719.8916 356.9784,-712.5842 354.0959,-718.9632"/>
</g>
<!-- proc~interp_fofields_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node5" class="node">
<title>proc~interp_fofields_p</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node5"><a xlink:href=".././proc/interp_fofields_p.html" xlink:title="interp_FOfields_p">
<polygon fill="#d9534f" stroke="#d9534f" points="439,-645 344,-645 344,-621 439,-621 439,-645"/>
<text text-anchor="middle" x="391.5" y="-630.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interp_FOfields_p</text>
</a>
</g>
</g>
<!-- proc~adv_fointerp_top&#45;&gt;proc~interp_fofields_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge4" class="edge">
<title>proc~adv_fointerp_top&#45;&gt;proc~interp_fofields_p</title>
<path fill="none" stroke="#000000" d="M97.2793,-582.3906C159.7318,-593.1332 267.7789,-611.7185 334.1176,-623.1296"/>
<polygon fill="#000000" stroke="#000000" points="333.5438,-626.5822 343.9924,-624.8281 334.7305,-619.6835 333.5438,-626.5822"/>
</g>
<!-- proc~advance_fointerp_vars -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node6" class="node">
<title>proc~advance_fointerp_vars</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node6"><a xlink:href=".././proc/advance_fointerp_vars.html" xlink:title="advance_FOinterp_vars">
<polygon fill="#d9534f" stroke="#d9534f" points="264,-439 139,-439 139,-415 264,-415 264,-439"/>
<text text-anchor="middle" x="201.5" y="-424.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advance_FOinterp_vars</text>
</a>
</g>
</g>
<!-- proc~adv_fointerp_top&#45;&gt;proc~advance_fointerp_vars -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge5" class="edge">
<title>proc~adv_fointerp_top&#45;&gt;proc~advance_fointerp_vars</title>
<path fill="none" stroke="#000000" d="M56.5072,-561.6909C70.3514,-541.0358 100.4237,-498.8333 133,-470 143.976,-460.2851 157.3908,-451.3431 169.4303,-444.1591"/>
<polygon fill="#000000" stroke="#000000" points="171.4025,-447.0617 178.3057,-439.0244 167.8971,-441.0026 171.4025,-447.0617"/>
</g>
<!-- proc~include_coulombcollisions_fo_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node12" class="node">
<title>proc~include_coulombcollisions_fo_p</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node12"><a xlink:href=".././proc/include_coulombcollisions_fo_p.html" xlink:title="include_CoulombCollisions_FO_p">
<polygon fill="#d9534f" stroke="#d9534f" points="477,-439 306,-439 306,-415 477,-415 477,-439"/>
<text text-anchor="middle" x="391.5" y="-424.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">include_CoulombCollisions_FO_p</text>
</a>
</g>
</g>
<!-- proc~advance_fp3dinterp_vars&#45;&gt;proc~include_coulombcollisions_fo_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge6" class="edge">
<title>proc~advance_fp3dinterp_vars&#45;&gt;proc~include_coulombcollisions_fo_p</title>
<path fill="none" stroke="#000000" d="M237.2375,-478.9621C268.0568,-468.5809 312.7307,-453.5328 346.0796,-442.2995"/>
<polygon fill="#000000" stroke="#000000" points="347.2407,-445.6017 355.6002,-439.0926 345.0061,-438.9679 347.2407,-445.6017"/>
</g>
<!-- proc~check_if_in_fields_domain_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node7" class="node">
<title>proc~check_if_in_fields_domain_p</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node7"><a xlink:href=".././proc/check_if_in_fields_domain_p.html" xlink:title="check_if_in_fields_domain_p">
<polygon fill="#d9534f" stroke="#d9534f" points="660,-704 513,-704 513,-680 660,-680 660,-704"/>
<text text-anchor="middle" x="586.5" y="-689.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">check_if_in_fields_domain_p</text>
</a>
</g>
</g>
<!-- proc~interp_fofields1_p&#45;&gt;proc~check_if_in_fields_domain_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge8" class="edge">
<title>proc~interp_fofields1_p&#45;&gt;proc~check_if_in_fields_domain_p</title>
<path fill="none" stroke="#000000" d="M442.2249,-721.5949C465.2351,-716.8749 492.8004,-711.2204 517.6432,-706.1245"/>
<polygon fill="#000000" stroke="#000000" points="518.6447,-709.492 527.7374,-704.0539 517.238,-702.6348 518.6447,-709.492"/>
</g>
<!-- proc~calculate_magnetic_field_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node8" class="node">
<title>proc~calculate_magnetic_field_p</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node8"><a xlink:href=".././proc/calculate_magnetic_field_p.html" xlink:title="calculate_magnetic_field_p">
<polygon fill="#d9534f" stroke="#d9534f" points="656,-822 517,-822 517,-798 656,-798 656,-822"/>
<text text-anchor="middle" x="586.5" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">calculate_magnetic_field_p</text>
</a>
</g>
</g>
<!-- proc~interp_fofields1_p&#45;&gt;proc~calculate_magnetic_field_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge7" class="edge">
<title>proc~interp_fofields1_p&#45;&gt;proc~calculate_magnetic_field_p</title>
<path fill="none" stroke="#000000" d="M418.3188,-744.0672C442.8027,-754.9426 480.0849,-771.1501 513,-784 522.0771,-787.5437 531.8616,-791.1504 541.2378,-794.5046"/>
<polygon fill="#000000" stroke="#000000" points="540.2194,-797.8568 550.8142,-797.8952 542.5558,-791.2582 540.2194,-797.8568"/>
</g>
<!-- ezspline_interp -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node10" class="node">
<title>ezspline_interp</title>
<polygon fill="#777777" stroke="#777777" points="816,-761 733,-761 733,-737 816,-737 816,-761"/>
<text text-anchor="middle" x="774.5" y="-746.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ezspline_interp</text>
</g>
<!-- proc~interp_fofields1_p&#45;&gt;ezspline_interp -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge9" class="edge">
<title>proc~interp_fofields1_p&#45;&gt;ezspline_interp</title>
<path fill="none" stroke="#000000" d="M442.2346,-739.0298C463.9791,-741.7353 489.6898,-744.5273 513,-746 585.6407,-750.5894 669.851,-750.6073 722.6545,-749.9795"/>
<polygon fill="#000000" stroke="#000000" points="722.8305,-753.4776 732.7837,-749.8465 722.7385,-746.4782 722.8305,-753.4776"/>
</g>
<!-- ezspline_error -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node11" class="node">
<title>ezspline_error</title>
<polygon fill="#777777" stroke="#777777" points="814,-680 735,-680 735,-656 814,-656 814,-680"/>
<text text-anchor="middle" x="774.5" y="-665.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ezspline_error</text>
</g>
<!-- proc~interp_fofields1_p&#45;&gt;ezspline_error -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge10" class="edge">
<title>proc~interp_fofields1_p&#45;&gt;ezspline_error</title>
<path fill="none" stroke="#000000" d="M442.144,-732.9562C496.6253,-732.9374 585.479,-729.8645 660,-713 688.127,-706.6347 718.4352,-694.466 740.7996,-684.3863"/>
<polygon fill="#000000" stroke="#000000" points="742.5514,-687.4331 750.1735,-680.0742 739.626,-681.0737 742.5514,-687.4331"/>
</g>
<!-- proc~interp_fofields_p&#45;&gt;proc~check_if_in_fields_domain_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge11" class="edge">
<title>proc~interp_fofields_p&#45;&gt;proc~check_if_in_fields_domain_p</title>
<path fill="none" stroke="#000000" d="M431.4317,-645.0819C461.9275,-654.3088 504.1296,-667.0777 536.809,-676.9653"/>
<polygon fill="#000000" stroke="#000000" points="536.0366,-680.3882 546.6217,-679.9343 538.0638,-673.6882 536.0366,-680.3882"/>
</g>
<!-- proc~interp_fofields_p&#45;&gt;ezspline_interp -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge12" class="edge">
<title>proc~interp_fofields_p&#45;&gt;ezspline_interp</title>
<path fill="none" stroke="#000000" d="M439.2128,-633.2787C494.2073,-635.0513 586.4591,-642.5352 660,-671 678.9249,-678.3251 722.6471,-709.8814 750.255,-730.5433"/>
<polygon fill="#000000" stroke="#000000" points="748.5059,-733.6074 758.6006,-736.8244 752.7153,-728.0144 748.5059,-733.6074"/>
</g>
<!-- proc~interp_fofields_p&#45;&gt;ezspline_error -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge13" class="edge">
<title>proc~interp_fofields_p&#45;&gt;ezspline_error</title>
<path fill="none" stroke="#000000" d="M439.297,-630.4879C493.1992,-628.4424 583.3361,-627.3969 660,-638 682.6537,-641.1331 707.2499,-647.2117 727.8185,-653.0827"/>
<polygon fill="#000000" stroke="#000000" points="726.9856,-656.4857 737.5661,-655.9343 728.9511,-649.7673 726.9856,-656.4857"/>
</g>
<!-- proc~radiation_force_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node9" class="node">
<title>proc~radiation_force_p</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node9"><a xlink:href=".././proc/radiation_force_p.html" xlink:title="radiation_force_p">
<polygon fill="#d9534f" stroke="#d9534f" points="438.5,-397 344.5,-397 344.5,-373 438.5,-373 438.5,-397"/>
<text text-anchor="middle" x="391.5" y="-382.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">radiation_force_p</text>
</a>
</g>
</g>
<!-- proc~advance_fointerp_vars&#45;&gt;proc~radiation_force_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge15" class="edge">
<title>proc~advance_fointerp_vars&#45;&gt;proc~radiation_force_p</title>
<path fill="none" stroke="#000000" d="M255.9464,-414.9645C280.5229,-409.5318 309.5572,-403.1137 334.4375,-397.6138"/>
<polygon fill="#000000" stroke="#000000" points="335.4534,-400.9738 344.4622,-395.3978 333.9425,-394.1388 335.4534,-400.9738"/>
</g>
<!-- proc~advance_fointerp_vars&#45;&gt;proc~include_coulombcollisions_fo_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge14" class="edge">
<title>proc~advance_fointerp_vars&#45;&gt;proc~include_coulombcollisions_fo_p</title>
<path fill="none" stroke="#000000" d="M264.2397,-427C274.315,-427 284.9396,-427 295.5796,-427"/>
<polygon fill="#000000" stroke="#000000" points="295.7682,-430.5001 305.7682,-427 295.7682,-423.5001 295.7682,-430.5001"/>
</g>
<!-- proc~calculate_magnetic_field_p&#45;&gt;ezspline_interp -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge16" class="edge">
<title>proc~calculate_magnetic_field_p&#45;&gt;ezspline_interp</title>
<path fill="none" stroke="#000000" d="M623.6428,-797.9484C653.5118,-788.2568 695.6494,-774.5845 727.8014,-764.1522"/>
<polygon fill="#000000" stroke="#000000" points="729.0028,-767.4421 737.4344,-761.0266 726.8424,-760.7838 729.0028,-767.4421"/>
</g>
<!-- proc~calculate_magnetic_field_p&#45;&gt;ezspline_error -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge17" class="edge">
<title>proc~calculate_magnetic_field_p&#45;&gt;ezspline_error</title>
<path fill="none" stroke="#000000" d="M602.5288,-797.8932C635.5499,-772.9517 711.3247,-715.7175 750.3278,-686.2578"/>
<polygon fill="#000000" stroke="#000000" points="752.6417,-688.8962 758.5118,-680.0762 748.4227,-683.3105 752.6417,-688.8962"/>
</g>
<!-- ezspline_gradient -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node16" class="node">
<title>ezspline_gradient</title>
<polygon fill="#777777" stroke="#777777" points="822,-822 727,-822 727,-798 822,-798 822,-822"/>
<text text-anchor="middle" x="774.5" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ezspline_gradient</text>
</g>
<!-- proc~calculate_magnetic_field_p&#45;&gt;ezspline_gradient -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge18" class="edge">
<title>proc~calculate_magnetic_field_p&#45;&gt;ezspline_gradient</title>
<path fill="none" stroke="#000000" d="M656.2371,-810C676.1672,-810 697.6593,-810 716.7843,-810"/>
<polygon fill="#000000" stroke="#000000" points="716.8437,-813.5001 726.8437,-810 716.8437,-806.5001 716.8437,-813.5001"/>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;cart_to_cyl_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge21" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;cart_to_cyl_p</title>
<path fill="none" stroke="#000000" d="M399.7086,-439.0807C417.3959,-464.1761 461.6819,-522.1729 513,-553 520.9367,-557.7676 530.0063,-561.4963 539.0018,-564.3983"/>
<polygon fill="#000000" stroke="#000000" points="538.0961,-567.78 548.6768,-567.2328 540.0642,-561.0623 538.0961,-567.78"/>
</g>
<!-- proc~unitvectors_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node13" class="node">
<title>proc~unitvectors_p</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node13"><a xlink:href=".././proc/unitvectors_p.html" xlink:title="unitVectors_p">
<polygon fill="#d9534f" stroke="#d9534f" points="625,-63 548,-63 548,-39 625,-39 625,-63"/>
<text text-anchor="middle" x="586.5" y="-48.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">unitVectors_p</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~unitvectors_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge19" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~unitvectors_p</title>
<path fill="none" stroke="#000000" d="M466.6941,-414.8673C470.4955,-412.3823 473.981,-409.4514 477,-406 575.2984,-293.6204 416.8232,-186.2006 513,-72 519.4757,-64.3108 528.5544,-59.3333 538.1288,-56.1361"/>
<polygon fill="#000000" stroke="#000000" points="539.0655,-59.5085 547.7903,-53.4977 537.2215,-52.7557 539.0655,-59.5085"/>
</g>
<!-- proc~analytical_profiles_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node14" class="node">
<title>proc~analytical_profiles_p</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node14"><a xlink:href=".././proc/analytical_profiles_p.html" xlink:title="analytical_profiles_p">
<polygon fill="#d9534f" stroke="#d9534f" points="640.5,-502 532.5,-502 532.5,-478 640.5,-478 640.5,-502"/>
<text text-anchor="middle" x="586.5" y="-487.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">analytical_profiles_p</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~analytical_profiles_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge20" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~analytical_profiles_p</title>
<path fill="none" stroke="#000000" d="M424.8583,-439.0807C449.1784,-447.7536 482.9886,-459.5332 513,-469 519.4626,-471.0386 526.2714,-473.0994 533.031,-475.0925"/>
<polygon fill="#000000" stroke="#000000" points="532.2738,-478.5173 542.8536,-477.9537 534.2315,-471.7966 532.2738,-478.5173"/>
</g>
<!-- proc~cf_sd -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node15" class="node">
<title>proc~cf_sd</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node15"><a xlink:href=".././proc/cf_sd.html" xlink:title="CF_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="613.5,-460 559.5,-460 559.5,-436 613.5,-436 613.5,-460"/>
<text text-anchor="middle" x="586.5" y="-445.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CF_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~cf_sd -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge22" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~cf_sd</title>
<path fill="none" stroke="#000000" d="M477.0298,-436.2109C502.3011,-438.9324 528.6616,-441.7712 549.1814,-443.9811"/>
<polygon fill="#000000" stroke="#000000" points="549.0255,-447.4844 559.3428,-445.0754 549.7751,-440.5247 549.0255,-447.4844"/>
</g>
<!-- proc~interp_focollision_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node17" class="node">
<title>proc~interp_focollision_p</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node17"><a xlink:href=".././proc/interp_focollision_p.html" xlink:title="interp_FOcollision_p">
<polygon fill="#d9534f" stroke="#d9534f" points="640.5,-544 532.5,-544 532.5,-520 640.5,-520 640.5,-544"/>
<text text-anchor="middle" x="586.5" y="-529.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">interp_FOcollision_p</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~interp_focollision_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge23" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~interp_focollision_p</title>
<path fill="none" stroke="#000000" d="M405.8697,-439.2968C427.6752,-457.3854 471.0369,-491.1625 513,-511 517.2743,-513.0206 521.7823,-514.8855 526.3762,-516.5989"/>
<polygon fill="#000000" stroke="#000000" points="525.2844,-519.9248 535.8792,-519.9045 527.5842,-513.3133 525.2844,-519.9248"/>
</g>
<!-- proc~dca_sd -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node18" class="node">
<title>proc~dca_sd</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node18"><a xlink:href=".././proc/dca_sd.html" xlink:title="dCA_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="613.5,-376 559.5,-376 559.5,-352 613.5,-352 613.5,-376"/>
<text text-anchor="middle" x="586.5" y="-361.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dCA_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~dca_sd -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge24" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~dca_sd</title>
<path fill="none" stroke="#000000" d="M450.1613,-414.9687C459.2854,-412.4205 468.4985,-409.4397 477,-406 494.1711,-399.0527 495.962,-392.2676 513,-385 524.6347,-380.0372 537.7943,-375.8588 549.7305,-372.5687"/>
<polygon fill="#000000" stroke="#000000" points="550.6321,-375.9507 559.4089,-370.0163 548.8469,-369.1822 550.6321,-375.9507"/>
</g>
<!-- proc~cb_ei_sd -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node19" class="node">
<title>proc~cb_ei_sd</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node19"><a xlink:href=".././proc/cb_ei_sd.html" xlink:title="CB_ei_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="617.5,-224 555.5,-224 555.5,-200 617.5,-200 617.5,-224"/>
<text text-anchor="middle" x="586.5" y="-209.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CB_ei_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~cb_ei_sd -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge25" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~cb_ei_sd</title>
<path fill="none" stroke="#000000" d="M464.2234,-414.9243C468.8399,-412.4525 473.1646,-409.5068 477,-406 513.4087,-372.7106 488.9037,-344.0482 513,-301 527.7691,-274.6149 550.6627,-248.4137 566.9724,-231.3462"/>
<polygon fill="#000000" stroke="#000000" points="569.4819,-233.7859 573.9499,-224.1793 564.4663,-228.9029 569.4819,-233.7859"/>
</g>
<!-- proc~get_random -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node20" class="node">
<title>proc~get_random</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node20"><a xlink:href=".././proc/get_random.html" xlink:title="get_random">
<polygon fill="#d94e8f" stroke="#d94e8f" points="621,-105 552,-105 552,-81 621,-81 621,-105"/>
<text text-anchor="middle" x="586.5" y="-90.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">get_random</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~get_random -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge26" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~get_random</title>
<path fill="none" stroke="#000000" d="M466.0742,-414.8992C470.0815,-412.414 473.7774,-409.4737 477,-406 542.894,-334.9729 474.8517,-280.0594 513,-191 525.9841,-160.6878 550.2033,-131.1433 567.2845,-112.5566"/>
<polygon fill="#000000" stroke="#000000" points="570.0362,-114.7397 574.3392,-105.058 564.9378,-109.9432 570.0362,-114.7397"/>
</g>
<!-- proc~cb_ee_sd -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node21" class="node">
<title>proc~cb_ee_sd</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node21"><a xlink:href=".././proc/cb_ee_sd.html" xlink:title="CB_ee_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="619,-334 554,-334 554,-310 619,-310 619,-334"/>
<text text-anchor="middle" x="586.5" y="-319.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CB_ee_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~cb_ee_sd -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge27" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~cb_ee_sd</title>
<path fill="none" stroke="#000000" d="M461.8199,-414.86C467.2187,-412.4198 472.363,-409.4977 477,-406 502.746,-386.5798 487.6222,-362.8989 513,-343 521.9552,-335.9781 533.1578,-331.3042 544.0973,-328.1931"/>
<polygon fill="#000000" stroke="#000000" points="545.1261,-331.5444 553.9979,-325.7528 543.4509,-324.7478 545.1261,-331.5444"/>
</g>
<!-- proc~ca_sd -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node22" class="node">
<title>proc~ca_sd</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node22"><a xlink:href=".././proc/ca_sd.html" xlink:title="CA_SD">
<polygon fill="#d94e8f" stroke="#d94e8f" points="613.5,-418 559.5,-418 559.5,-394 613.5,-394 613.5,-418"/>
<text text-anchor="middle" x="586.5" y="-403.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CA_SD</text>
</a>
</g>
</g>
<!-- proc~include_coulombcollisions_fo_p&#45;&gt;proc~ca_sd -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge28" class="edge">
<title>proc~include_coulombcollisions_fo_p&#45;&gt;proc~ca_sd</title>
<path fill="none" stroke="#000000" d="M477.0298,-417.7891C502.3011,-415.0676 528.6616,-412.2288 549.1814,-410.0189"/>
<polygon fill="#000000" stroke="#000000" points="549.7751,-413.4753 559.3428,-408.9246 549.0255,-406.5156 549.7751,-413.4753"/>
</g>
<!-- proc~gammacee -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node24" class="node">
<title>proc~gammacee</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node24"><a xlink:href=".././proc/gammacee.html" xlink:title="Gammacee">
<polygon fill="#d94e8f" stroke="#d94e8f" points="808,-340 741,-340 741,-316 808,-316 808,-340"/>
<text text-anchor="middle" x="774.5" y="-325.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Gammacee</text>
</a>
</g>
</g>
<!-- proc~cf_sd&#45;&gt;proc~gammacee -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge29" class="edge">
<title>proc~cf_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M613.8385,-443.9594C628.3606,-440.9147 646.0413,-435.7153 660,-427 680.2879,-414.333 678.3578,-403.1494 696,-387 712.3403,-372.0424 732.3165,-357.0689 748.0281,-345.9491"/>
<polygon fill="#000000" stroke="#000000" points="750.0748,-348.7888 756.2678,-340.1925 746.0657,-343.0505 750.0748,-348.7888"/>
</g>
<!-- proc~vte -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node25" class="node">
<title>proc~vte</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node25"><a xlink:href=".././proc/vte.html" xlink:title="VTe">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1033,-285 979,-285 979,-261 1033,-261 1033,-285"/>
<text text-anchor="middle" x="1006" y="-270.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">VTe</text>
</a>
</g>
</g>
<!-- proc~cf_sd&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge30" class="edge">
<title>proc~cf_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M613.5746,-450.2115C628.7244,-452.6987 647.0994,-457.9487 660,-469 688.9961,-493.8396 663.8389,-526.4223 696,-547 754.7763,-584.607 792.0742,-581.0145 853,-547 950.2442,-492.7092 989.7427,-350.4165 1001.7122,-295.2779"/>
<polygon fill="#000000" stroke="#000000" points="1005.2027,-295.6822 1003.8039,-285.1801 998.3482,-294.2622 1005.2027,-295.6822"/>
</g>
<!-- proc~psi -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node29" class="node">
<title>proc~psi</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node29"><a xlink:href=".././proc/psi.html" xlink:title="psi">
<polygon fill="#d94e8f" stroke="#d94e8f" points="801.5,-420 747.5,-420 747.5,-396 801.5,-396 801.5,-420"/>
<text text-anchor="middle" x="774.5" y="-405.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">psi</text>
</a>
</g>
</g>
<!-- proc~cf_sd&#45;&gt;proc~psi -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge31" class="edge">
<title>proc~cf_sd&#45;&gt;proc~psi</title>
<path fill="none" stroke="#000000" d="M613.8368,-442.1837C646.3707,-435.2616 700.8545,-423.6692 737.2307,-415.9296"/>
<polygon fill="#000000" stroke="#000000" points="738.3825,-419.263 747.4352,-413.7585 736.9257,-412.4162 738.3825,-419.263"/>
</g>
<!-- proc~clogee -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node31" class="node">
<title>proc~clogee</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node31"><a xlink:href=".././proc/clogee.html" xlink:title="CLogee">
<polygon fill="#d94e8f" stroke="#d94e8f" points="943,-264 889,-264 889,-240 943,-240 943,-264"/>
<text text-anchor="middle" x="916" y="-249.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CLogee</text>
</a>
</g>
</g>
<!-- proc~cf_sd&#45;&gt;proc~clogee -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge32" class="edge">
<title>proc~cf_sd&#45;&gt;proc~clogee</title>
<path fill="none" stroke="#000000" d="M613.7899,-455.4889C666.8311,-468.2431 784.6163,-487.4913 853,-429 907.0735,-382.7488 850.7055,-332.972 889,-273 889.3296,-272.4839 889.6764,-271.9752 890.0386,-271.4743"/>
<polygon fill="#000000" stroke="#000000" points="892.681,-273.7727 896.9442,-264.0734 887.563,-268.9972 892.681,-273.7727"/>
</g>
<!-- proc~h_j -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node32" class="node">
<title>proc~h_j</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node32"><a xlink:href=".././proc/h_j.html" xlink:title="h_j">
<polygon fill="#d94e8f" stroke="#d94e8f" points="801.5,-538 747.5,-538 747.5,-514 801.5,-514 801.5,-538"/>
<text text-anchor="middle" x="774.5" y="-523.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">h_j</text>
</a>
</g>
</g>
<!-- proc~cf_sd&#45;&gt;proc~h_j -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge33" class="edge">
<title>proc~cf_sd&#45;&gt;proc~h_j</title>
<path fill="none" stroke="#000000" d="M613.7686,-452.8407C628.1042,-456.101 645.6329,-461.2516 660,-469 678.5842,-479.0228 677.628,-489.5934 696,-500 708.7416,-507.2173 723.7918,-512.8109 737.2882,-516.9289"/>
<polygon fill="#000000" stroke="#000000" points="736.6642,-520.3912 747.2421,-519.7927 738.5997,-513.6641 736.6642,-520.3912"/>
</g>
<!-- proc~interp_focollision_p&#45;&gt;ezspline_interp -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge34" class="edge">
<title>proc~interp_focollision_p&#45;&gt;ezspline_interp</title>
<path fill="none" stroke="#000000" d="M640.7194,-540.3921C647.8906,-543.421 654.6107,-547.5044 660,-553 703.7789,-597.6423 661.2919,-636.9915 696,-689 707.7297,-706.5764 726.3478,-721.1305 742.5087,-731.5011"/>
<polygon fill="#000000" stroke="#000000" points="740.8222,-734.5727 751.1749,-736.8248 744.4862,-728.6082 740.8222,-734.5727"/>
</g>
<!-- proc~interp_focollision_p&#45;&gt;ezspline_error -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge36" class="edge">
<title>proc~interp_focollision_p&#45;&gt;ezspline_error</title>
<path fill="none" stroke="#000000" d="M640.5634,-541.6777C647.5877,-544.5307 654.3071,-548.2228 660,-553 688.0169,-576.5103 670.5098,-600.7716 696,-627 705.82,-637.1044 718.6687,-645.2285 731.1193,-651.4953"/>
<polygon fill="#000000" stroke="#000000" points="729.969,-654.8226 740.5061,-655.9275 732.9579,-648.4928 729.969,-654.8226"/>
</g>
<!-- proc~check_if_in_profiles_domain_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node26" class="node">
<title>proc~check_if_in_profiles_domain_p</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node26"><a xlink:href=".././proc/check_if_in_profiles_domain_p.html" xlink:title="check_if_in_profiles_domain_p">
<polygon fill="#d9534f" stroke="#d9534f" points="853,-618 696,-618 696,-594 853,-594 853,-618"/>
<text text-anchor="middle" x="774.5" y="-603.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">check_if_in_profiles_domain_p</text>
</a>
</g>
</g>
<!-- proc~interp_focollision_p&#45;&gt;proc~check_if_in_profiles_domain_p -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge35" class="edge">
<title>proc~interp_focollision_p&#45;&gt;proc~check_if_in_profiles_domain_p</title>
<path fill="none" stroke="#000000" d="M638.019,-544.111C645.563,-546.6265 653.106,-549.5766 660,-553 677.913,-561.8951 678.2755,-570.7348 696,-580 703.5901,-583.9676 711.9056,-587.498 720.1963,-590.5794"/>
<polygon fill="#000000" stroke="#000000" points="719.2776,-593.9666 729.8724,-593.9898 721.6045,-587.3647 719.2776,-593.9666"/>
</g>
<!-- proc~dca_sd&#45;&gt;proc~gammacee -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge38" class="edge">
<title>proc~dca_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M613.8368,-358.7653C644.4242,-352.9081 694.4137,-343.3357 730.5158,-336.4225"/>
<polygon fill="#000000" stroke="#000000" points="731.6057,-339.7775 740.769,-334.4591 730.2892,-332.9024 731.6057,-339.7775"/>
</g>
<!-- proc~dca_sd&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge37" class="edge">
<title>proc~dca_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M613.715,-365.1728C662.3394,-366.6724 767.0903,-367.1956 853,-349 894.8312,-340.1402 904.9668,-334.5403 943,-315 956.417,-308.1068 970.4639,-298.9545 981.8802,-290.9534"/>
<polygon fill="#000000" stroke="#000000" points="983.9452,-293.7796 990.0436,-285.1158 979.8735,-288.0856 983.9452,-293.7796"/>
</g>
<!-- proc~dca_sd&#45;&gt;proc~psi -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge39" class="edge">
<title>proc~dca_sd&#45;&gt;proc~psi</title>
<path fill="none" stroke="#000000" d="M613.8368,-370.398C646.5103,-378.045 701.3226,-390.8734 737.6981,-399.3868"/>
<polygon fill="#000000" stroke="#000000" points="736.9007,-402.7947 747.4352,-401.6657 738.4959,-395.9789 736.9007,-402.7947"/>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~gammacee -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge40" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M606.264,-224.1948C639.7784,-244.8739 707.8593,-286.8812 746.3478,-310.6295"/>
<polygon fill="#000000" stroke="#000000" points="744.6526,-313.6961 755.0008,-315.9686 748.3284,-307.7389 744.6526,-313.6961"/>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge41" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M617.7738,-206.5813C681.3584,-196.919 829.3176,-181.3929 943,-223 960.2599,-229.317 976.4258,-242.3561 988.0598,-253.5349"/>
<polygon fill="#000000" stroke="#000000" points="985.8172,-256.2436 995.3479,-260.8714 990.7833,-251.3103 985.8172,-256.2436"/>
</g>
<!-- proc~g_j -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node27" class="node">
<title>proc~g_j</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node27"><a xlink:href=".././proc/g_j.html" xlink:title="g_j">
<polygon fill="#d94e8f" stroke="#d94e8f" points="801.5,-146 747.5,-146 747.5,-122 801.5,-122 801.5,-146"/>
<text text-anchor="middle" x="774.5" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">g_j</text>
</a>
</g>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~g_j -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge42" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~g_j</title>
<path fill="none" stroke="#000000" d="M609.6241,-199.9918C631.5347,-188.8612 665.5311,-172.2261 696,-160 709.378,-154.6319 724.3377,-149.475 737.5803,-145.1895"/>
<polygon fill="#000000" stroke="#000000" points="738.8486,-148.459 747.3178,-142.0932 736.7273,-141.7882 738.8486,-148.459"/>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~clogee -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge43" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~clogee</title>
<path fill="none" stroke="#000000" d="M617.7956,-215.7992C678.6639,-223.1883 812.7602,-239.4671 878.3635,-247.4311"/>
<polygon fill="#000000" stroke="#000000" points="878.3097,-250.9502 888.6587,-248.6809 879.1534,-244.0012 878.3097,-250.9502"/>
</g>
<!-- proc~clogei -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node33" class="node">
<title>proc~clogei</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node33"><a xlink:href=".././proc/clogei.html" xlink:title="CLogei">
<polygon fill="#d94e8f" stroke="#d94e8f" points="943,-146 889,-146 889,-122 943,-122 943,-146"/>
<text text-anchor="middle" x="916" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CLogei</text>
</a>
</g>
</g>
<!-- proc~cb_ei_sd&#45;&gt;proc~clogei -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge44" class="edge">
<title>proc~cb_ei_sd&#45;&gt;proc~clogei</title>
<path fill="none" stroke="#000000" d="M594.9994,-199.8464C611.4463,-177.5279 650.0801,-130.6808 696,-113 761.1176,-87.9274 784.1232,-101.8228 853,-113 861.6703,-114.407 870.7599,-116.8365 879.2512,-119.5553"/>
<polygon fill="#000000" stroke="#000000" points="878.289,-122.925 888.8835,-122.8359 880.5458,-116.2987 878.289,-122.925"/>
</g>
<!-- interface~random_get_number_u -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node23" class="node">
<title>interface~random_get_number_u</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node23"><a xlink:href=".././interface/random_get_number_u.html" xlink:title="random_get_number_U">
<polygon fill="#a7506f" stroke="#a7506f" points="836,-66 713,-66 713,-42 836,-42 836,-66"/>
<text text-anchor="middle" x="774.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">random_get_number_U</text>
</a>
</g>
</g>
<!-- proc~get_random&#45;&gt;interface~random_get_number_u -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge45" class="edge">
<title>proc~get_random&#45;&gt;interface~random_get_number_u</title>
<path fill="none" stroke="#000000" d="M621.4208,-85.7558C645.2628,-80.8098 677.6324,-74.0949 706.4654,-68.1136"/>
<polygon fill="#000000" stroke="#000000" points="707.4161,-71.4909 716.4966,-66.0326 705.9942,-64.6369 707.4161,-71.4909"/>
</g>
<!-- omp_get_thread_num -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node28" class="node">
<title>omp_get_thread_num</title>
<polygon fill="#777777" stroke="#777777" points="832,-24 717,-24 717,0 832,0 832,-24"/>
<text text-anchor="middle" x="774.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">omp_get_thread_num</text>
</g>
<!-- proc~get_random&#45;&gt;omp_get_thread_num -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge46" class="edge">
<title>proc~get_random&#45;&gt;omp_get_thread_num</title>
<path fill="none" stroke="#000000" d="M621.0345,-87.2341C633.9128,-84.0582 648.2468,-79.2357 660,-72 680.0876,-59.6333 675.8086,-45.1964 696,-33 699.6001,-30.8254 703.4262,-28.8725 707.377,-27.1192"/>
<polygon fill="#000000" stroke="#000000" points="708.7767,-30.3292 716.774,-23.3797 706.1885,-23.8252 708.7767,-30.3292"/>
</g>
<!-- proc~cb_ee_sd&#45;&gt;proc~gammacee -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge49" class="edge">
<title>proc~cb_ee_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M619.2471,-323.0451C650.1369,-324.031 696.6576,-325.5157 730.7217,-326.6028"/>
<polygon fill="#000000" stroke="#000000" points="730.7557,-330.1056 740.8623,-326.9265 730.979,-323.1092 730.7557,-330.1056"/>
</g>
<!-- proc~cb_ee_sd&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge47" class="edge">
<title>proc~cb_ee_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M615.8954,-309.9982C669.2144,-288.9488 785.91,-246.1703 889,-231 912.7443,-227.5059 920.0298,-224.0452 943,-231 958.239,-235.614 973.161,-245.2642 984.6546,-254.1519"/>
<polygon fill="#000000" stroke="#000000" points="982.7544,-257.1176 992.7239,-260.7038 987.1668,-251.6833 982.7544,-257.1176"/>
</g>
<!-- proc~cb_ee_sd&#45;&gt;proc~psi -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge50" class="edge">
<title>proc~cb_ee_sd&#45;&gt;proc~psi</title>
<path fill="none" stroke="#000000" d="M619.2711,-329.5741C632.1976,-333.0209 647.0285,-337.5568 660,-343 691.3078,-356.1376 724.8315,-375.9121 747.4599,-390.1992"/>
<polygon fill="#000000" stroke="#000000" points="745.8476,-393.3225 756.1582,-395.7603 749.6182,-387.4248 745.8476,-393.3225"/>
</g>
<!-- proc~delta -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node30" class="node">
<title>proc~delta</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node30"><a xlink:href=".././proc/delta.html" xlink:title="delta">
<polygon fill="#d94e8f" stroke="#d94e8f" points="943,-306 889,-306 889,-282 943,-282 943,-306"/>
<text text-anchor="middle" x="916" y="-291.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">delta</text>
</a>
</g>
</g>
<!-- proc~cb_ee_sd&#45;&gt;proc~delta -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge48" class="edge">
<title>proc~cb_ee_sd&#45;&gt;proc~delta</title>
<path fill="none" stroke="#000000" d="M619.004,-316.8781C640.7479,-313.6169 670.0285,-309.5424 696,-307 760.0249,-300.7325 834.8491,-297.09 878.6689,-295.328"/>
<polygon fill="#000000" stroke="#000000" points="878.9965,-298.818 888.8522,-294.9301 878.7232,-291.8233 878.9965,-298.818"/>
</g>
<!-- proc~ca_sd&#45;&gt;proc~gammacee -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge52" class="edge">
<title>proc~ca_sd&#45;&gt;proc~gammacee</title>
<path fill="none" stroke="#000000" d="M613.772,-399.4852C627.7904,-395.8174 645.0293,-390.8083 660,-385 689.476,-373.564 721.5833,-357.2166 744.2768,-344.9588"/>
<polygon fill="#000000" stroke="#000000" points="745.9885,-348.012 753.0892,-340.1486 742.6347,-341.8677 745.9885,-348.012"/>
</g>
<!-- proc~ca_sd&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge51" class="edge">
<title>proc~ca_sd&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M613.702,-413.3535C635.7086,-418.9036 667.5977,-426.0493 696,-429 765.4042,-436.2104 788.3098,-455.1556 853,-429 919.5056,-402.1104 971.2425,-329.8257 993.7408,-293.8828"/>
<polygon fill="#000000" stroke="#000000" points="996.8336,-295.5339 999.0615,-285.1759 990.8605,-291.8838 996.8336,-295.5339"/>
</g>
<!-- proc~ca_sd&#45;&gt;proc~psi -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge53" class="edge">
<title>proc~ca_sd&#45;&gt;proc~psi</title>
<path fill="none" stroke="#000000" d="M613.8368,-406.2908C646.3707,-406.6369 700.8545,-407.2165 737.2307,-407.6035"/>
<polygon fill="#000000" stroke="#000000" points="737.3985,-411.1054 747.4352,-407.7121 737.473,-404.1058 737.3985,-411.1054"/>
</g>
<!-- proc~gammacee&#45;&gt;proc~clogee -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge54" class="edge">
<title>proc~gammacee&#45;&gt;proc~clogee</title>
<path fill="none" stroke="#000000" d="M796.9211,-315.9576C820.4828,-303.3025 857.7426,-283.2902 884.3057,-269.0231"/>
<polygon fill="#000000" stroke="#000000" points="886.0616,-272.0529 893.2152,-264.2377 882.7494,-265.8861 886.0616,-272.0529"/>
</g>
<!-- proc~delta&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge55" class="edge">
<title>proc~delta&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M943.003,-287.6993C951.1158,-285.8063 960.1631,-283.6953 968.8131,-281.677"/>
<polygon fill="#000000" stroke="#000000" points="969.7619,-285.0496 978.705,-279.3688 968.1713,-278.2328 969.7619,-285.0496"/>
</g>
<!-- proc~clogee&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge56" class="edge">
<title>proc~clogee&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M943.003,-258.3007C951.1158,-260.1937 960.1631,-262.3047 968.8131,-264.323"/>
<polygon fill="#000000" stroke="#000000" points="968.1713,-267.7672 978.705,-266.6312 969.7619,-260.9504 968.1713,-267.7672"/>
</g>
<!-- proc~clog0 -->
<g id="proc~~adv_fointerp_top~~CallsGraph_node34" class="node">
<title>proc~clog0</title>
<g id="a_proc~~adv_fointerp_top~~CallsGraph_node34"><a xlink:href=".././proc/clog0.html" xlink:title="CLog0">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1033,-205 979,-205 979,-181 1033,-181 1033,-205"/>
<text text-anchor="middle" x="1006" y="-190.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CLog0</text>
</a>
</g>
</g>
<!-- proc~clogee&#45;&gt;proc~clog0 -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge57" class="edge">
<title>proc~clogee&#45;&gt;proc~clog0</title>
<path fill="none" stroke="#000000" d="M934.6481,-239.7752C947.5247,-231.3338 964.8462,-219.9786 979.1979,-210.5703"/>
<polygon fill="#000000" stroke="#000000" points="981.2395,-213.417 987.6838,-205.0073 977.4017,-207.5628 981.2395,-213.417"/>
</g>
<!-- proc~clogei&#45;&gt;proc~vte -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge58" class="edge">
<title>proc~clogei&#45;&gt;proc~vte</title>
<path fill="none" stroke="#000000" d="M930.2675,-146.2364C934.6348,-150.3616 939.2668,-155.1542 943,-160 965.6693,-189.4253 985.3406,-227.9894 996.4272,-251.6057"/>
<polygon fill="#000000" stroke="#000000" points="993.273,-253.1239 1000.6367,-260.7415 999.6306,-250.1945 993.273,-253.1239"/>
</g>
<!-- proc~clogei&#45;&gt;proc~clog0 -->
<g id="proc~~adv_fointerp_top~~CallsGraph_edge59" class="edge">
<title>proc~clogei&#45;&gt;proc~clog0</title>
<path fill="none" stroke="#000000" d="M934.6481,-146.2248C947.5247,-154.6662 964.8462,-166.0214 979.1979,-175.4297"/>
<polygon fill="#000000" stroke="#000000" points="977.4017,-178.4372 987.6838,-180.9927 981.2395,-172.583 977.4017,-178.4372"/>
</g>
</g>
</svg>
</div><script>var panprocadv_fointerp_topCallsGraph = svgPanZoom('#procadv_fointerp_topCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="554pt" height="32pt"
 viewBox="0.00 0.00 553.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 549.5,-28 549.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="63,-24 0,-24 0,0 63,0 63,-24"/>
<text text-anchor="middle" x="31.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="135.5,-24 81.5,-24 81.5,0 135.5,0 135.5,-24"/>
<text text-anchor="middle" x="108.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="207.5,-24 153.5,-24 153.5,0 207.5,0 207.5,-24"/>
<text text-anchor="middle" x="180.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="359.5,-24 225.5,-24 225.5,0 359.5,0 359.5,-24"/>
<text text-anchor="middle" x="292.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="431.5,-24 377.5,-24 377.5,0 431.5,0 431.5,-24"/>
<text text-anchor="middle" x="404.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="545.5,-24 449.5,-24 449.5,0 545.5,0 545.5,-24"/>
<text text-anchor="middle" x="497.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~adv_fointerp_top~~CalledByGraph Pages: 1 -->
<svg id="procadv_fointerp_topCalledByGraph" width="195pt" height="32pt"
 viewBox="0.00 0.00 195.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~adv_fointerp_top~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~adv_fointerp_top~~CalledByGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 191,-28 191,4 -4,4"/>
<!-- proc~adv_fointerp_top -->
<g id="proc~~adv_fointerp_top~~CalledByGraph_node1" class="node">
<title>proc~adv_fointerp_top</title>
<polygon fill="none" stroke="#000000" points="187,-24 90,-24 90,0 187,0 187,-24"/>
<text text-anchor="middle" x="138.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">adv_FOinterp_top</text>
</g>
<!-- program~main -->
<g id="proc~~adv_fointerp_top~~CalledByGraph_node2" class="node">
<title>program~main</title>
<g id="a_proc~~adv_fointerp_top~~CalledByGraph_node2"><a xlink:href=".././program/main.html" xlink:title="main">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">main</text>
</a>
</g>
</g>
<!-- program~main&#45;&gt;proc~adv_fointerp_top -->
<g id="proc~~adv_fointerp_top~~CalledByGraph_edge1" class="edge">
<title>program~main&#45;&gt;proc~adv_fointerp_top</title>
<path fill="none" stroke="#000000" d="M54.276,-12C62.0518,-12 70.8379,-12 79.7268,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.758,-15.5001 89.7579,-12 79.7579,-8.5001 79.758,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="554pt" height="32pt"
 viewBox="0.00 0.00 553.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 549.5,-28 549.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="63,-24 0,-24 0,0 63,0 63,-24"/>
<text text-anchor="middle" x="31.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="135.5,-24 81.5,-24 81.5,0 135.5,0 135.5,-24"/>
<text text-anchor="middle" x="108.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="207.5,-24 153.5,-24 153.5,0 207.5,0 207.5,-24"/>
<text text-anchor="middle" x="180.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="359.5,-24 225.5,-24 225.5,0 359.5,0 359.5,-24"/>
<text text-anchor="middle" x="292.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="431.5,-24 377.5,-24 377.5,0 431.5,0 431.5,-24"/>
<text text-anchor="middle" x="404.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="545.5,-24 449.5,-24 449.5,0 545.5,0 545.5,-24"/>
<text text-anchor="middle" x="497.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/adv_fointerp_top.html#src">adv_FOinterp_top</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>  <span class="k">subroutine </span><span class="n">adv_FOinterp_top</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">spp</span><span class="p">)</span>  
    <span class="k">TYPE</span><span class="p">(</span><span class="n">KORC_PARAMS</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>                           <span class="kd">::</span> <span class="n">params</span>
    <span class="c">!! Core KORC simulation parameters.</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">FIELDS</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                                   <span class="kd">::</span> <span class="n">F</span>
    <span class="c">!! An instance of the KORC derived type FIELDS.</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">PROFILES</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                                 <span class="kd">::</span> <span class="n">P</span>
    <span class="c">!! An instance of the KORC derived type PROFILES.</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">SPECIES</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">spp</span>
    <span class="c">!! An instance of the derived type SPECIES containing all the parameters</span>
    <span class="c">!! and simulation variables of the different species in the simulation.</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">Bmag</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">b_unit_X</span><span class="p">,</span><span class="n">b_unit_Y</span><span class="p">,</span><span class="n">b_unit_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">v</span><span class="p">,</span><span class="n">vpar</span><span class="p">,</span><span class="n">vperp</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">tmp</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">g</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">cross_X</span><span class="p">,</span><span class="n">cross_Y</span><span class="p">,</span><span class="n">cross_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">vec_X</span><span class="p">,</span><span class="n">vec_Y</span><span class="p">,</span><span class="n">vec_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">X_X</span><span class="p">,</span><span class="n">X_Y</span><span class="p">,</span><span class="n">X_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">V_X</span><span class="p">,</span><span class="n">V_Y</span><span class="p">,</span><span class="n">V_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">B_X</span><span class="p">,</span><span class="n">B_Y</span><span class="p">,</span><span class="n">B_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">E_X</span><span class="p">,</span><span class="n">E_Y</span><span class="p">,</span><span class="n">E_Z</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PSIp</span>
    <span class="kt">INTEGER</span><span class="p">(</span><span class="k">is</span><span class="p">),</span><span class="k">DIMENSION</span><span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span><span class="p">)</span> <span class="kd">::</span> <span class="n">flagCon</span><span class="p">,</span><span class="n">flagCol</span>
    <span class="kt">REAL</span><span class="p">(</span><span class="n">rp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span><span class="p">,</span><span class="n">m_cache</span><span class="p">,</span><span class="n">q_cache</span>    
    <span class="kt">INTEGER</span>                                                    <span class="kd">::</span> <span class="n">ii</span>
    <span class="c">!! Species iterator.</span>
    <span class="kt">INTEGER</span>                                                    <span class="kd">::</span> <span class="n">pp</span><span class="p">,</span><span class="n">pchunk</span>
    <span class="c">!! Particles iterator.</span>
    <span class="kt">INTEGER</span>                                                    <span class="kd">::</span> <span class="n">cc</span>
    <span class="c">!! Chunk iterator.</span>
    <span class="kt">INTEGER</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>                                                    <span class="kd">::</span> <span class="n">tt</span>
    <span class="c">!! time iterator.     </span>

    <span class="k">do </span><span class="n">ii</span> <span class="o">=</span> <span class="mi">1_idef</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">num_species</span>      

       <span class="n">pchunk</span><span class="o">=</span><span class="n">params</span><span class="p">%</span><span class="n">pchunk</span>
       <span class="n">m_cache</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">m</span>
       <span class="n">q_cache</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">q</span>
       <span class="n">a</span> <span class="o">=</span> <span class="n">q_cache</span><span class="o">*</span><span class="n">params</span><span class="p">%</span><span class="n">dt</span><span class="o">/</span><span class="n">m_cache</span>


       <span class="c">!$OMP PARALLEL DO default(none) &amp;</span>
       <span class="c">!$OMP&amp; FIRSTPRIVATE(a,m_cache,q_cache,pchunk) &amp;</span>
       <span class="c">!$OMP&amp; shared(params,ii,spp,P,F) &amp;</span>
       <span class="c">!$OMP&amp; PRIVATE(E0,pp,tt,Bmag,cc,X_X,X_Y,X_Z,V_X,V_Y,V_Z,B_X,B_Y,B_Z, &amp;</span>
       <span class="c">!$OMP&amp; E_X,E_Y,E_Z,b_unit_X,b_unit_Y,b_unit_Z,v,vpar,vperp,tmp, &amp;</span>
       <span class="c">!$OMP&amp; cross_X,cross_Y,cross_Z,vec_X,vec_Y,vec_Z,g, &amp;</span>
       <span class="c">!$OMP&amp; Y_R,Y_PHI,Y_Z,flagCon,flagCol,PSIp)</span>
       <span class="k">do </span><span class="n">pp</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">ppp</span><span class="p">,</span><span class="n">pchunk</span>

          <span class="c">!$OMP SIMD</span>
          <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">pchunk</span>
             <span class="n">X_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
             <span class="n">X_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
             <span class="n">X_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

             <span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
             <span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
             <span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

             <span class="n">PSIp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">PSI_P</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span>

             <span class="n">g</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">g</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span>

             <span class="n">flagCon</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">flagCon</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">flagCol</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">flagCol</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span>
          <span class="k">end do</span>
          <span class="c">!$OMP END SIMD</span>

          <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">params</span><span class="p">%</span><span class="n">FokPlan</span><span class="p">)</span> <span class="k">then</span>
<span class="k">             do </span><span class="n">tt</span><span class="o">=</span><span class="mi">1_ip</span><span class="p">,</span><span class="n">params</span><span class="p">%</span><span class="n">t_skip</span>

                <span class="k">call </span><span class="n">cart_to_cyl_p</span><span class="p">(</span><span class="n">pchunk</span><span class="p">,</span><span class="n">X_X</span><span class="p">,</span><span class="n">X_Y</span><span class="p">,</span><span class="n">X_Z</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">)</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;new&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                   call </span><span class="n">interp_FOfields_p</span><span class="p">(</span><span class="n">pchunk</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">,</span><span class="n">B_X</span><span class="p">,</span><span class="n">B_Y</span><span class="p">,</span><span class="n">B_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">E_X</span><span class="p">,</span><span class="n">E_Y</span><span class="p">,</span><span class="n">E_Z</span><span class="p">,</span><span class="n">PSIp</span><span class="p">,</span><span class="n">flagCon</span><span class="p">)</span>
                <span class="k">else if</span> <span class="p">(</span><span class="n">params</span><span class="p">%</span><span class="n">orbit_model</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="s1">&#39;old&#39;</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                   call </span><span class="n">interp_FOfields1_p</span><span class="p">(</span><span class="n">pchunk</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">Y_R</span><span class="p">,</span><span class="n">Y_PHI</span><span class="p">,</span><span class="n">Y_Z</span><span class="p">,</span><span class="n">B_X</span><span class="p">,</span><span class="n">B_Y</span><span class="p">,</span><span class="n">B_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                        <span class="n">E_X</span><span class="p">,</span><span class="n">E_Y</span><span class="p">,</span><span class="n">E_Z</span><span class="p">,</span><span class="n">PSIp</span><span class="p">,</span><span class="n">flagCon</span><span class="p">)</span>
                <span class="k">end if</span>


                <span class="c">!               write(output_unit_write,&#39;(&quot;B_X: &quot;,E17.10)&#39;) B_X(1)</span>
                <span class="c">!               write(output_unit_write,&#39;(&quot;B_Y: &quot;,E17.10)&#39;) B_Y(1)</span>
                <span class="c">!               write(output_unit_write,&#39;(&quot;B_Z: &quot;,E17.10)&#39;) B_Z(1)</span>

                <span class="k">call </span><span class="n">advance_FOinterp_vars</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">q_cache</span><span class="p">,</span><span class="n">m_cache</span><span class="p">,</span><span class="n">params</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">X_X</span><span class="p">,</span><span class="n">X_Y</span><span class="p">,</span><span class="n">X_Z</span><span class="p">,</span><span class="n">V_X</span><span class="p">,</span><span class="n">V_Y</span><span class="p">,</span><span class="n">V_Z</span><span class="p">,</span><span class="n">B_X</span><span class="p">,</span><span class="n">B_Y</span><span class="p">,</span><span class="n">B_Z</span><span class="p">,</span><span class="n">E_X</span><span class="p">,</span><span class="n">E_Y</span><span class="p">,</span><span class="n">E_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">g</span><span class="p">,</span><span class="n">flagCon</span><span class="p">,</span><span class="n">flagCol</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">PSIp</span><span class="p">)</span>
             <span class="k">end do</span> <span class="c">!timestep iterator</span>

             <span class="c">!$OMP SIMD</span>
             <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">pchunk</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">X_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">X_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">X</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">X_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">g</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">flagCon</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">flagCon</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">flagCol</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">flagCol</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">PSI_P</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">PSIp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="k">end do</span>
             <span class="c">!$OMP END SIMD</span>

          <span class="k">else</span>
             <span class="c">!$OMP SIMD</span>
             <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">pchunk</span>
                <span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">B</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

                <span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">=</span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">E</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
             <span class="k">end do</span>
             <span class="c">!$OMP END SIMD</span>

             <span class="k">call </span><span class="n">advance_FP3Dinterp_vars</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">X_X</span><span class="p">,</span><span class="n">X_Y</span><span class="p">,</span><span class="n">X_Z</span><span class="p">,</span><span class="n">V_X</span><span class="p">,</span><span class="n">V_Y</span><span class="p">,</span><span class="n">V_Z</span><span class="p">,</span> <span class="p">&amp;</span>
                  <span class="n">g</span><span class="p">,</span><span class="n">m_cache</span><span class="p">,</span><span class="n">B_X</span><span class="p">,</span><span class="n">B_Y</span><span class="p">,</span><span class="n">B_Z</span><span class="p">,</span><span class="n">E_X</span><span class="p">,</span><span class="n">E_Y</span><span class="p">,</span><span class="n">E_Z</span><span class="p">,</span><span class="n">flagCon</span><span class="p">,</span><span class="n">flagCol</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">PSIp</span><span class="p">)</span>

             <span class="c">!$OMP SIMD</span>
             <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">pchunk</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">V</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">g</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">flagCol</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">flagCol</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

             <span class="k">end do</span>
             <span class="c">!$OMP END SIMD</span>
          <span class="k">end if</span>

          <span class="c">!$OMP SIMD</span>
          <span class="c">!          !$OMP&amp; aligned(Bmag,B_X,B_Y,B_Z, &amp;</span>
          <span class="c">!          !$OMP&amp; b_unit_X,b_unit_Y,b_unit_Z,v,V_X,V_Y,V_Z,vpar, &amp;</span>
          <span class="c">!          !$OMP&amp; vperp,tmp,cross_X,cross_Y,cross_Z, &amp;</span>
          <span class="c">!          !$OMP&amp; vec_X,vec_Y,vec_Z,E_X,E_Y,E_Z)</span>
          <span class="k">do </span><span class="n">cc</span><span class="o">=</span><span class="mi">1_idef</span><span class="p">,</span><span class="n">pchunk</span>
             <span class="c">!Derived output data</span>
             <span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>

             <span class="c">! Parallel unit vector</span>
             <span class="n">b_unit_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">/</span><span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">b_unit_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">/</span><span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
             <span class="n">b_unit_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">/</span><span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

             <span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
             <span class="k">if</span> <span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">).</span><span class="n">GT</span><span class="p">.</span><span class="n">korc_zero</span><span class="p">)</span> <span class="k">then</span>
                <span class="c">! Parallel and perpendicular components of velocity</span>
                <span class="n">vpar</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">b_unit_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">b_unit_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span> <span class="p">&amp;</span>
                     <span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">b_unit_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>

                <span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span>  <span class="n">v</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">vpar</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
                <span class="k">if</span> <span class="p">(</span> <span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">korc_zero</span> <span class="p">)</span> <span class="k">then</span>
<span class="k">                   </span><span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span> <span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="p">)</span>
                <span class="k">else</span>
<span class="k">                   </span><span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
                <span class="k">end if</span>

                <span class="c">! Pitch angle</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">eta</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mi">18</span><span class="mf">0.0_rp</span><span class="o">*</span> <span class="p">&amp;</span>
                     <span class="nb">MODULO</span><span class="p">(</span><span class="n">ATAN2</span><span class="p">(</span><span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">),</span><span class="n">vpar</span><span class="p">(</span><span class="n">cc</span><span class="p">)),</span><span class="mf">2.0_rp</span><span class="o">*</span><span class="n">C_PI</span><span class="p">)</span><span class="o">/</span><span class="n">C_PI</span>

                <span class="c">! Magnetic moment</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">mu</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.5_rp</span><span class="o">*</span><span class="n">m_cache</span><span class="o">*</span> <span class="p">&amp;</span>
                     <span class="n">g</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">vperp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">Bmag</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="c">! See Northrop&#39;s book (The adiabatic motion of charged</span>
                <span class="c">! particles)</span>

                <span class="c">! Radiated power</span>
                <span class="n">tmp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">q_cache</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="mf">6.0_rp</span><span class="o">*</span><span class="n">C_PI</span><span class="o">*</span><span class="n">E0</span><span class="o">*</span><span class="n">m_cache</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

                <span class="n">cross_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">-</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">cross_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">-</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">cross_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">-</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">B_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">vec_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">+</span> <span class="n">cross_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">vec_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">+</span> <span class="n">cross_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                <span class="n">vec_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">+</span> <span class="n">cross_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>

                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">Prad</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span> <span class="p">&amp;</span>
                     <span class="p">(</span> <span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
                     <span class="n">cross_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">cross_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span> <span class="p">&amp;</span>
                     <span class="n">cross_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">+</span> <span class="n">g</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span> <span class="p">&amp;</span>
                     <span class="p">((</span><span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="p">&amp;</span>
                     <span class="o">-</span> <span class="n">vec_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">vec_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">vec_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">vec_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span> <span class="p">&amp;</span>
                     <span class="n">vec_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">vec_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span> <span class="p">)</span>

                <span class="c">! Input power due to electric field</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">Pin</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="n">q_cache</span><span class="o">*</span><span class="p">(</span><span class="n">E_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_X</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span> <span class="p">&amp;</span>
                     <span class="n">E_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Y</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">+</span><span class="n">E_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">*</span><span class="n">V_Z</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
             <span class="k">else</span>
<span class="k">                </span><span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">eta</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">mu</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">Prad</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
                <span class="n">spp</span><span class="p">(</span><span class="n">ii</span><span class="p">)%</span><span class="n">vars</span><span class="p">%</span><span class="n">Pin</span><span class="p">(</span><span class="n">pp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cc</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0_rp</span>
             <span class="k">end if</span>

<span class="k">          end do</span>
          <span class="c">!$OMP END SIMD</span>


       <span class="k">end do</span> <span class="c">!particle chunk iterator</span>
       <span class="c">!$OMP END PARALLEL DO</span>

    <span class="k">end do</span> <span class="c">!species iterator</span>

  <span class="k">end subroutine </span><span class="n">adv_FOinterp_top</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> KORC was developed by Matt Beidler</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>